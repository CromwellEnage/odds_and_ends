// Copyright (C) 2025 Cromwell D. Enage

#include <odds_and_ends/node/data.hpp>
#include <odds_and_ends/node/tree/base.hpp>
#include <odds_and_ends/node/tree/binary.hpp>
#include <odds_and_ends/node/iterator/breadth_first_tree.hpp>
#include <odds_and_ends/composite_type/composite_type.hpp>
#include <boost/mpl/bool.hpp>
#include <boost/mpl/deque.hpp>
#include <boost/core/lightweight_test.hpp>

typedef ::odds_and_ends::composite_type::composite_type<
    ::boost::mpl::deque<
        ::odds_and_ends::node::data<int const>,
        ::odds_and_ends::node::tree::base<>,
        ::odds_and_ends::node::tree::binary<>
    >
> binary_tree_node;

void test_00()
{
    binary_tree_node btn_p09(9);
    binary_tree_node btn_p17(17);
    binary_tree_node btn_p23(23);
    binary_tree_node btn_p50(50);
    binary_tree_node btn_p76(76);

    BOOST_TEST(9 == *btn_p09);
    BOOST_TEST(17 == *btn_p17);
    BOOST_TEST(23 == *btn_p23);
    BOOST_TEST(50 == *btn_p50);
    BOOST_TEST(76 == *btn_p76);
    btn_p50.set_left(btn_p17);
    btn_p50.set_right(btn_p76);
    btn_p17.set_left(btn_p09);
    btn_p17.set_right(btn_p23);
    BOOST_TEST(!btn_p50.parent());
    BOOST_TEST(50 == **btn_p17.parent());
    BOOST_TEST(17 == **btn_p50.left());
    BOOST_TEST(50 == **btn_p76.parent());
    BOOST_TEST(76 == **btn_p50.right());
    BOOST_TEST(17 == **btn_p09.parent());
    BOOST_TEST(9 == **btn_p17.left());
    BOOST_TEST(17 == **btn_p23.parent());
    BOOST_TEST(23 == **btn_p17.right());
    BOOST_TEST(!btn_p09.left());
    BOOST_TEST(!btn_p09.right());
    BOOST_TEST(!btn_p23.left());
    BOOST_TEST(!btn_p23.right());
    BOOST_TEST(!btn_p76.left());
    BOOST_TEST(!btn_p76.right());

    ::odds_and_ends::node::breadth_first_tree_iterator<binary_tree_node> bft_fwd_itr(btn_p50);

    BOOST_TEST(50 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(17 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(76 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(9 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(23 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(!bft_fwd_itr);

    ::odds_and_ends::node::breadth_first_tree_iterator<
        binary_tree_node,
        ::boost::mpl::true_
    > bft_bkd_itr(btn_p50);

    BOOST_TEST(50 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(76 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(17 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(23 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(9 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(!bft_bkd_itr);

    binary_tree_node::traits::pointer rotate_result = btn_p50.rotate_right();

    BOOST_TEST(17 == **rotate_result);
    BOOST_TEST(!btn_p17.parent());
    BOOST_TEST(17 == **btn_p09.parent());
    BOOST_TEST(9 == **btn_p17.left());
    BOOST_TEST(17 == **btn_p50.parent());
    BOOST_TEST(50 == **btn_p17.right());
    BOOST_TEST(50 == **btn_p23.parent());
    BOOST_TEST(23 == **btn_p50.left());
    BOOST_TEST(50 == **btn_p76.parent());
    BOOST_TEST(76 == **btn_p50.right());
    BOOST_TEST(!btn_p09.left());
    BOOST_TEST(!btn_p09.right());
    BOOST_TEST(!btn_p23.left());
    BOOST_TEST(!btn_p23.right());
    BOOST_TEST(!btn_p76.left());
    BOOST_TEST(!btn_p76.right());
    bft_fwd_itr = ::odds_and_ends::node::make_breadth_first_tree_iterator(btn_p17);
    BOOST_TEST(17 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(9 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(50 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(23 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(76 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(!bft_fwd_itr);
    bft_bkd_itr = ::odds_and_ends::node::make_breadth_first_tree_iterator<
        ::boost::mpl::true_
    >(btn_p17);
    BOOST_TEST(17 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(50 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(9 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(76 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(23 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(!bft_bkd_itr);
    btn_p17.swap(btn_p50);
    BOOST_TEST(17 == **btn_p50.right());
    BOOST_TEST(50 == **btn_p17.parent());
    bft_fwd_itr = ::odds_and_ends::node::make_breadth_first_tree_iterator(btn_p50);
    BOOST_TEST(50 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(9 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(17 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(23 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(76 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(!bft_fwd_itr);
    bft_bkd_itr = ::odds_and_ends::node::make_breadth_first_tree_iterator<
        ::boost::mpl::true_
    >(btn_p50);
    BOOST_TEST(50 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(17 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(9 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(76 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(23 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(!bft_bkd_itr);
    btn_p17.swap(btn_p50);
    BOOST_TEST(50 == **btn_p17.right());
    BOOST_TEST(17 == **btn_p50.parent());
    bft_fwd_itr = ::odds_and_ends::node::make_breadth_first_tree_iterator(btn_p17);
    BOOST_TEST(17 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(9 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(50 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(23 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(76 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(!bft_fwd_itr);
    bft_bkd_itr = ::odds_and_ends::node::make_breadth_first_tree_iterator<
        ::boost::mpl::true_
    >(btn_p17);
    BOOST_TEST(17 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(50 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(9 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(76 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(23 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(!bft_bkd_itr);
    rotate_result = btn_p17.rotate_left();
    BOOST_TEST(50 == **rotate_result);
    BOOST_TEST(!btn_p50.parent());
    BOOST_TEST(50 == **btn_p17.parent());
    BOOST_TEST(17 == **btn_p50.left());
    BOOST_TEST(50 == **btn_p76.parent());
    BOOST_TEST(76 == **btn_p50.right());
    BOOST_TEST(17 == **btn_p09.parent());
    BOOST_TEST(9 == **btn_p17.left());
    BOOST_TEST(17 == **btn_p23.parent());
    BOOST_TEST(23 == **btn_p17.right());
    BOOST_TEST(!btn_p09.left());
    BOOST_TEST(!btn_p09.right());
    BOOST_TEST(!btn_p23.left());
    BOOST_TEST(!btn_p23.right());
    BOOST_TEST(!btn_p76.left());
    BOOST_TEST(!btn_p76.right());
    bft_fwd_itr = ::odds_and_ends::node::make_breadth_first_tree_iterator(btn_p50);
    BOOST_TEST(50 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(17 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(76 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(9 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(23 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(!bft_fwd_itr);
    bft_bkd_itr = ::odds_and_ends::node::make_breadth_first_tree_iterator<
        ::boost::mpl::true_
    >(btn_p50);
    BOOST_TEST(50 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(76 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(17 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(23 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(9 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(!bft_bkd_itr);
    btn_p50.swap(btn_p17);
    BOOST_TEST(50 == **btn_p17.left());
    BOOST_TEST(17 == **btn_p50.parent());
    bft_fwd_itr = ::odds_and_ends::node::make_breadth_first_tree_iterator(btn_p17);
    BOOST_TEST(17 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(50 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(76 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(9 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(23 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(!bft_fwd_itr);
    bft_bkd_itr = ::odds_and_ends::node::make_breadth_first_tree_iterator<
        ::boost::mpl::true_
    >(btn_p17);
    BOOST_TEST(17 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(76 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(50 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(23 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(9 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(!bft_bkd_itr);
    btn_p50.swap(btn_p17);
    BOOST_TEST(17 == **btn_p50.left());
    BOOST_TEST(50 == **btn_p17.parent());
    bft_fwd_itr = ::odds_and_ends::node::make_breadth_first_tree_iterator(btn_p50);
    BOOST_TEST(50 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(17 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(76 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(9 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(23 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(!bft_fwd_itr);
    bft_bkd_itr = ::odds_and_ends::node::make_breadth_first_tree_iterator<
        ::boost::mpl::true_
    >(btn_p50);
    BOOST_TEST(50 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(76 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(17 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(23 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(9 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(!bft_bkd_itr);
}

void test_01()
{
    binary_tree_node btn_p01(1);
    binary_tree_node btn_p06(6);
    binary_tree_node btn_p08(8);
    binary_tree_node btn_p11(11);
    binary_tree_node btn_p13(13);
    binary_tree_node btn_p15(15);
    binary_tree_node btn_p17(17);
    binary_tree_node btn_p22(22);
    binary_tree_node btn_p25(25);
    binary_tree_node btn_p27(27);

    BOOST_TEST(1 == *btn_p01);
    BOOST_TEST(!btn_p01.parent());
    BOOST_TEST(!btn_p01.left());
    BOOST_TEST(!btn_p01.right());
    BOOST_TEST(btn_p01.begin() == btn_p01.end());
    BOOST_TEST(btn_p01.rbegin() == btn_p01.rend());
    BOOST_TEST(6 == *btn_p06);
    BOOST_TEST(!btn_p06.parent());
    BOOST_TEST(!btn_p06.left());
    BOOST_TEST(!btn_p06.right());
    BOOST_TEST(btn_p06.begin() == btn_p06.end());
    BOOST_TEST(btn_p06.rbegin() == btn_p06.rend());
    BOOST_TEST(8 == *btn_p08);
    BOOST_TEST(!btn_p08.parent());
    BOOST_TEST(!btn_p08.left());
    BOOST_TEST(!btn_p08.right());
    BOOST_TEST(btn_p08.begin() == btn_p08.end());
    BOOST_TEST(btn_p08.rbegin() == btn_p08.rend());
    BOOST_TEST(11 == *btn_p11);
    BOOST_TEST(!btn_p11.parent());
    BOOST_TEST(!btn_p11.left());
    BOOST_TEST(!btn_p11.right());
    BOOST_TEST(btn_p11.begin() == btn_p11.end());
    BOOST_TEST(btn_p11.rbegin() == btn_p11.rend());
    BOOST_TEST(13 == *btn_p13);
    BOOST_TEST(!btn_p13.parent());
    BOOST_TEST(!btn_p13.left());
    BOOST_TEST(!btn_p13.right());
    BOOST_TEST(btn_p13.begin() == btn_p13.end());
    BOOST_TEST(btn_p13.rbegin() == btn_p13.rend());
    BOOST_TEST(15 == *btn_p15);
    BOOST_TEST(!btn_p15.parent());
    BOOST_TEST(!btn_p15.left());
    BOOST_TEST(!btn_p15.right());
    BOOST_TEST(btn_p15.begin() == btn_p15.end());
    BOOST_TEST(btn_p15.rbegin() == btn_p15.rend());
    BOOST_TEST(17 == *btn_p17);
    BOOST_TEST(!btn_p17.parent());
    BOOST_TEST(!btn_p17.left());
    BOOST_TEST(!btn_p17.right());
    BOOST_TEST(btn_p17.begin() == btn_p17.end());
    BOOST_TEST(btn_p17.rbegin() == btn_p17.rend());
    BOOST_TEST(22 == *btn_p22);
    BOOST_TEST(!btn_p22.parent());
    BOOST_TEST(!btn_p22.left());
    BOOST_TEST(!btn_p22.right());
    BOOST_TEST(btn_p22.begin() == btn_p22.end());
    BOOST_TEST(btn_p22.rbegin() == btn_p22.rend());
    BOOST_TEST(25 == *btn_p25);
    BOOST_TEST(!btn_p25.parent());
    BOOST_TEST(!btn_p25.left());
    BOOST_TEST(!btn_p25.right());
    BOOST_TEST(btn_p25.begin() == btn_p25.end());
    BOOST_TEST(btn_p25.rbegin() == btn_p25.rend());
    BOOST_TEST(27 == *btn_p27);
    BOOST_TEST(!btn_p27.parent());
    BOOST_TEST(!btn_p27.left());
    BOOST_TEST(!btn_p27.right());
    BOOST_TEST(btn_p27.begin() == btn_p27.end());
    BOOST_TEST(btn_p27.rbegin() == btn_p27.rend());
    btn_p06.set_left(btn_p01);
    BOOST_TEST(6 == **btn_p01.parent());
    BOOST_TEST(1 == **btn_p06.left());
    BOOST_TEST(1 == **btn_p06.begin());
    BOOST_TEST(btn_p06.begin() + 1 == btn_p06.end());
    BOOST_TEST(1 == **btn_p06.rbegin());
    BOOST_TEST(btn_p06.rbegin() + 1 == btn_p06.rend());
    btn_p08.set_left(btn_p06);
    BOOST_TEST(8 == **btn_p06.parent());
    BOOST_TEST(6 == **btn_p08.left());
    BOOST_TEST(6 == **btn_p08.begin());
    BOOST_TEST(btn_p08.begin() + 1 == btn_p08.end());
    BOOST_TEST(6 == **btn_p08.rbegin());
    BOOST_TEST(btn_p08.rbegin() + 1 == btn_p08.rend());
    btn_p08.set_right(btn_p11);
    BOOST_TEST(8 == **btn_p11.parent());
    BOOST_TEST(11 == **btn_p08.right());
    BOOST_TEST(6 == **btn_p08.begin());
    BOOST_TEST(11 == **(btn_p08.begin() + 1));
    BOOST_TEST(btn_p08.begin() + 2 == btn_p08.end());
    BOOST_TEST(11 == **btn_p08.rbegin());
    BOOST_TEST(6 == **(btn_p08.rbegin() + 1));
    BOOST_TEST(btn_p08.rbegin() + 2 == btn_p08.rend());
    btn_p13.set_left(btn_p08);
    BOOST_TEST(13 == **btn_p08.parent());
    BOOST_TEST(8 == **btn_p13.left());
    BOOST_TEST(8 == **btn_p13.begin());
    BOOST_TEST(btn_p13.begin() + 1 == btn_p13.end());
    BOOST_TEST(8 == **btn_p13.rbegin());
    BOOST_TEST(btn_p13.rbegin() + 1 == btn_p13.rend());
    btn_p13.set_right(btn_p17);
    BOOST_TEST(13 == **btn_p17.parent());
    BOOST_TEST(17 == **btn_p13.right());
    BOOST_TEST(8 == **btn_p13.begin());
    BOOST_TEST(17 == **(btn_p13.begin() + 1));
    BOOST_TEST(btn_p13.begin() + 2 == btn_p13.end());
    BOOST_TEST(17 == **btn_p13.rbegin());
    BOOST_TEST(8 == **(btn_p13.rbegin() + 1));
    BOOST_TEST(btn_p13.rbegin() + 2 == btn_p13.rend());
    btn_p17.set_left(btn_p15);
    BOOST_TEST(17 == **btn_p15.parent());
    BOOST_TEST(15 == **btn_p17.left());
    BOOST_TEST(15 == **btn_p17.begin());
    BOOST_TEST(btn_p17.begin() + 1 == btn_p17.end());
    BOOST_TEST(15 == **btn_p17.rbegin());
    BOOST_TEST(btn_p17.rbegin() + 1 == btn_p17.rend());
    btn_p17.set_right(btn_p25);
    BOOST_TEST(17 == **btn_p25.parent());
    BOOST_TEST(25 == **btn_p17.right());
    BOOST_TEST(15 == **btn_p17.begin());
    BOOST_TEST(25 == **(btn_p17.begin() + 1));
    BOOST_TEST(btn_p17.begin() + 2 == btn_p17.end());
    BOOST_TEST(25 == **btn_p17.rbegin());
    BOOST_TEST(15 == **(btn_p17.rbegin() + 1));
    BOOST_TEST(btn_p17.rbegin() + 2 == btn_p17.rend());
    btn_p25.set_left(btn_p22);
    BOOST_TEST(25 == **btn_p22.parent());
    BOOST_TEST(22 == **btn_p25.left());
    BOOST_TEST(22 == **btn_p25.begin());
    BOOST_TEST(btn_p25.begin() + 1 == btn_p25.end());
    btn_p25.set_right(btn_p27);
    BOOST_TEST(25 == **btn_p27.parent());
    BOOST_TEST(27 == **btn_p25.right());
    BOOST_TEST(22 == **btn_p25.begin());
    BOOST_TEST(27 == **(btn_p25.begin() + 1));
    BOOST_TEST(btn_p25.begin() + 2 == btn_p25.end());
    BOOST_TEST(27 == **btn_p25.rbegin());
    BOOST_TEST(22 == **(btn_p25.rbegin() + 1));
    BOOST_TEST(btn_p25.rbegin() + 2 == btn_p25.rend());

    ::odds_and_ends::node::breadth_first_tree_iterator<binary_tree_node> bft_fwd_itr(btn_p13);

    BOOST_TEST(13 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(8 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(17 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(6 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(11 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(15 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(25 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(1 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(22 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(27 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(!bft_fwd_itr);

    ::odds_and_ends::node::breadth_first_tree_iterator<
        binary_tree_node,
        ::boost::mpl::true_
    > bft_bkd_itr(btn_p13);

    BOOST_TEST(13 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(17 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(8 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(25 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(15 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(11 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(6 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(27 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(22 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(1 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(!bft_bkd_itr);
    btn_p17.swap(btn_p25);
    BOOST_TEST(25 == **btn_p13.right());
    BOOST_TEST(25 == **btn_p17.parent());
    BOOST_TEST(22 == **btn_p17.left());
    BOOST_TEST(27 == **btn_p17.right());
    BOOST_TEST(13 == **btn_p25.parent());
    BOOST_TEST(15 == **btn_p25.left());
    BOOST_TEST(17 == **btn_p25.right());
    BOOST_TEST(15 == **btn_p25.begin());
    BOOST_TEST(25 == **btn_p25.begin()->parent());
    BOOST_TEST(22 == **btn_p17.begin());
    BOOST_TEST(17 == **btn_p17.begin()->parent());
    BOOST_TEST(27 == **(btn_p17.begin() + 1));
    BOOST_TEST(17 == **(btn_p17.begin() + 1)->parent());
    BOOST_TEST(btn_p17.begin() + 2 == btn_p17.end());
    BOOST_TEST(27 == **btn_p17.rbegin());
    BOOST_TEST(17 == **btn_p17.rbegin()->parent());
    BOOST_TEST(22 == **(btn_p17.rbegin() + 1));
    BOOST_TEST(17 == **(btn_p17.rbegin() + 1)->parent());
    BOOST_TEST(btn_p17.rbegin() + 2 == btn_p17.rend());
    BOOST_TEST(17 == **(btn_p25.begin() + 1));
    BOOST_TEST(25 == **(btn_p25.begin() + 1)->parent());
    BOOST_TEST(btn_p25.begin() + 2 == btn_p25.end());
    BOOST_TEST(17 == **btn_p25.rbegin());
    BOOST_TEST(25 == **btn_p25.rbegin()->parent());
    BOOST_TEST(15 == **(btn_p25.rbegin() + 1));
    BOOST_TEST(25 == **(btn_p25.rbegin() + 1)->parent());
    BOOST_TEST(btn_p25.rbegin() + 2 == btn_p25.rend());
    bft_fwd_itr = ::odds_and_ends::node::make_breadth_first_tree_iterator(btn_p13);
    BOOST_TEST(13 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(8 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(25 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(6 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(11 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(15 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(17 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(1 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(22 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(27 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(!bft_fwd_itr);
    bft_bkd_itr = ::odds_and_ends::node::make_breadth_first_tree_iterator<
        ::boost::mpl::true_
    >(btn_p13);
    BOOST_TEST(13 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(25 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(8 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(17 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(15 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(11 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(6 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(27 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(22 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(1 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(!bft_bkd_itr);
    btn_p17.swap(btn_p25);
    BOOST_TEST(17 == **btn_p13.right());
    BOOST_TEST(13 == **btn_p17.parent());
    BOOST_TEST(15 == **btn_p17.left());
    BOOST_TEST(25 == **btn_p17.right());
    BOOST_TEST(17 == **btn_p25.parent());
    BOOST_TEST(22 == **btn_p25.left());
    BOOST_TEST(27 == **btn_p25.right());
    BOOST_TEST(15 == **btn_p17.begin());
    BOOST_TEST(17 == **btn_p17.begin()->parent());
    BOOST_TEST(25 == **(btn_p17.begin() + 1));
    BOOST_TEST(17 == **(btn_p17.begin() + 1)->parent());
    BOOST_TEST(btn_p17.begin() + 2 == btn_p17.end());
    BOOST_TEST(25 == **btn_p17.rbegin());
    BOOST_TEST(17 == **btn_p17.rbegin()->parent());
    BOOST_TEST(15 == **(btn_p17.rbegin() + 1));
    BOOST_TEST(17 == **(btn_p17.rbegin() + 1)->parent());
    BOOST_TEST(btn_p17.rbegin() + 2 == btn_p17.rend());
    BOOST_TEST(22 == **btn_p25.begin());
    BOOST_TEST(25 == **btn_p25.begin()->parent());
    BOOST_TEST(27 == **(btn_p25.begin() + 1));
    BOOST_TEST(25 == **(btn_p25.begin() + 1)->parent());
    BOOST_TEST(btn_p25.begin() + 2 == btn_p25.end());
    BOOST_TEST(27 == **btn_p25.rbegin());
    BOOST_TEST(25 == **btn_p25.rbegin()->parent());
    BOOST_TEST(22 == **(btn_p25.rbegin() + 1));
    BOOST_TEST(25 == **(btn_p25.rbegin() + 1)->parent());
    BOOST_TEST(btn_p25.rbegin() + 2 == btn_p25.rend());
    bft_fwd_itr = ::odds_and_ends::node::make_breadth_first_tree_iterator(btn_p13);
    BOOST_TEST(13 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(8 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(17 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(6 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(11 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(15 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(25 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(1 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(22 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(27 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(!bft_fwd_itr);
    bft_bkd_itr = ::odds_and_ends::node::make_breadth_first_tree_iterator<
        ::boost::mpl::true_
    >(btn_p13);
    BOOST_TEST(13 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(17 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(8 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(25 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(15 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(11 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(6 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(27 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(22 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(1 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(!bft_bkd_itr);

    binary_tree_node::traits::pointer rotate_result = btn_p08.rotate_right();

    BOOST_TEST(6 == **rotate_result);
    BOOST_TEST(6 == **btn_p01.parent());
    BOOST_TEST(!btn_p01.left());
    BOOST_TEST(!btn_p01.right());
    BOOST_TEST(btn_p01.begin() == btn_p01.end());
    BOOST_TEST(btn_p01.rbegin() == btn_p01.rend());
    BOOST_TEST(13 == **btn_p06.parent());
    BOOST_TEST(1 == **btn_p06.left());
    BOOST_TEST(8 == **btn_p06.right());
    BOOST_TEST(1 == **btn_p06.begin());
    BOOST_TEST(8 == **(btn_p06.begin() + 1));
    BOOST_TEST(btn_p06.begin() + 2 == btn_p06.end());
    BOOST_TEST(8 == **btn_p06.rbegin());
    BOOST_TEST(1 == **(btn_p06.rbegin() + 1));
    BOOST_TEST(btn_p06.rbegin() + 2 == btn_p06.rend());
    BOOST_TEST(6 == **btn_p08.parent());
    BOOST_TEST(!btn_p08.left());
    BOOST_TEST(11 == **btn_p08.right());
    BOOST_TEST(11 == **btn_p08.begin());
    BOOST_TEST(btn_p08.begin() + 1 == btn_p08.end());
    BOOST_TEST(11 == **btn_p08.rbegin());
    BOOST_TEST(btn_p08.rbegin() + 1 == btn_p08.rend());
    BOOST_TEST(8 == **btn_p11.parent());
    BOOST_TEST(!btn_p11.left());
    BOOST_TEST(!btn_p11.right());
    BOOST_TEST(btn_p11.begin() == btn_p11.end());
    BOOST_TEST(btn_p11.rbegin() == btn_p11.rend());
    BOOST_TEST(!btn_p13.parent());
    BOOST_TEST(6 == **btn_p13.left());
    BOOST_TEST(17 == **btn_p13.right());
    BOOST_TEST(6 == **btn_p13.begin());
    BOOST_TEST(17 == **(btn_p13.begin() + 1));
    BOOST_TEST(btn_p13.begin() + 2 == btn_p13.end());
    BOOST_TEST(17 == **btn_p13.rbegin());
    BOOST_TEST(6 == **(btn_p13.rbegin() + 1));
    BOOST_TEST(btn_p13.rbegin() + 2 == btn_p13.rend());
    BOOST_TEST(17 == **btn_p15.parent());
    BOOST_TEST(!btn_p15.left());
    BOOST_TEST(!btn_p15.right());
    BOOST_TEST(btn_p15.begin() == btn_p15.end());
    BOOST_TEST(btn_p15.rbegin() == btn_p15.rend());
    BOOST_TEST(13 == **btn_p17.parent());
    BOOST_TEST(15 == **btn_p17.left());
    BOOST_TEST(25 == **btn_p17.right());
    BOOST_TEST(15 == **btn_p17.begin());
    BOOST_TEST(25 == **(btn_p17.begin() + 1));
    BOOST_TEST(btn_p17.begin() + 2 == btn_p17.end());
    BOOST_TEST(25 == **btn_p17.rbegin());
    BOOST_TEST(15 == **(btn_p17.rbegin() + 1));
    BOOST_TEST(btn_p17.rbegin() + 2 == btn_p17.rend());
    BOOST_TEST(25 == **btn_p22.parent());
    BOOST_TEST(!btn_p22.left());
    BOOST_TEST(!btn_p22.right());
    BOOST_TEST(btn_p22.begin() == btn_p22.end());
    BOOST_TEST(btn_p22.rbegin() == btn_p22.rend());
    BOOST_TEST(17 == **btn_p25.parent());
    BOOST_TEST(22 == **btn_p25.left());
    BOOST_TEST(27 == **btn_p25.right());
    BOOST_TEST(22 == **btn_p25.begin());
    BOOST_TEST(27 == **(btn_p25.begin() + 1));
    BOOST_TEST(btn_p25.begin() + 2 == btn_p25.end());
    BOOST_TEST(27 == **btn_p25.rbegin());
    BOOST_TEST(22 == **(btn_p25.rbegin() + 1));
    BOOST_TEST(btn_p25.rbegin() + 2 == btn_p25.rend());
    BOOST_TEST(25 == **btn_p27.parent());
    BOOST_TEST(!btn_p27.left());
    BOOST_TEST(!btn_p27.right());
    BOOST_TEST(btn_p27.begin() == btn_p27.end());
    BOOST_TEST(btn_p27.rbegin() == btn_p27.rend());
    bft_fwd_itr = ::odds_and_ends::node::make_breadth_first_tree_iterator(btn_p13);
    BOOST_TEST(13 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(6 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(17 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(1 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(8 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(15 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(25 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(11 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(22 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(27 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(!bft_fwd_itr);
    bft_bkd_itr = ::odds_and_ends::node::make_breadth_first_tree_iterator<
        ::boost::mpl::true_
    >(btn_p13);
    BOOST_TEST(13 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(17 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(6 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(25 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(15 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(8 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(1 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(27 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(22 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(11 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(!bft_bkd_itr);
    rotate_result = btn_p17.rotate_left();
    BOOST_TEST(25 == **rotate_result);
    BOOST_TEST(6 == **btn_p01.parent());
    BOOST_TEST(!btn_p01.left());
    BOOST_TEST(!btn_p01.right());
    BOOST_TEST(btn_p01.begin() == btn_p01.end());
    BOOST_TEST(btn_p01.rbegin() == btn_p01.rend());
    BOOST_TEST(13 == **btn_p06.parent());
    BOOST_TEST(1 == **btn_p06.left());
    BOOST_TEST(8 == **btn_p06.right());
    BOOST_TEST(1 == **btn_p06.begin());
    BOOST_TEST(8 == **(btn_p06.begin() + 1));
    BOOST_TEST(btn_p06.begin() + 2 == btn_p06.end());
    BOOST_TEST(8 == **btn_p06.rbegin());
    BOOST_TEST(1 == **(btn_p06.rbegin() + 1));
    BOOST_TEST(btn_p06.rbegin() + 2 == btn_p06.rend());
    BOOST_TEST(6 == **btn_p08.parent());
    BOOST_TEST(!btn_p08.left());
    BOOST_TEST(11 == **btn_p08.right());
    BOOST_TEST(11 == **btn_p08.begin());
    BOOST_TEST(btn_p08.begin() + 1 == btn_p08.end());
    BOOST_TEST(11 == **btn_p08.rbegin());
    BOOST_TEST(btn_p08.rbegin() + 1 == btn_p08.rend());
    BOOST_TEST(8 == **btn_p11.parent());
    BOOST_TEST(!btn_p11.left());
    BOOST_TEST(!btn_p11.right());
    BOOST_TEST(btn_p11.begin() == btn_p11.end());
    BOOST_TEST(btn_p11.rbegin() == btn_p11.rend());
    BOOST_TEST(!btn_p13.parent());
    BOOST_TEST(6 == **btn_p13.left());
    BOOST_TEST(25 == **btn_p13.right());
    BOOST_TEST(6 == **btn_p13.begin());
    BOOST_TEST(25 == **(btn_p13.begin() + 1));
    BOOST_TEST(btn_p13.begin() + 2 == btn_p13.end());
    BOOST_TEST(25 == **btn_p13.rbegin());
    BOOST_TEST(6 == **(btn_p13.rbegin() + 1));
    BOOST_TEST(btn_p13.rbegin() + 2 == btn_p13.rend());
    BOOST_TEST(17 == **btn_p15.parent());
    BOOST_TEST(!btn_p15.left());
    BOOST_TEST(!btn_p15.right());
    BOOST_TEST(btn_p15.begin() == btn_p15.end());
    BOOST_TEST(btn_p15.rbegin() == btn_p15.rend());
    BOOST_TEST(25 == **btn_p17.parent());
    BOOST_TEST(15 == **btn_p17.left());
    BOOST_TEST(22 == **btn_p17.right());
    BOOST_TEST(15 == **btn_p17.begin());
    BOOST_TEST(22 == **(btn_p17.begin() + 1));
    BOOST_TEST(btn_p17.begin() + 2 == btn_p17.end());
    BOOST_TEST(22 == **btn_p17.rbegin());
    BOOST_TEST(15 == **(btn_p17.rbegin() + 1));
    BOOST_TEST(btn_p17.rbegin() + 2 == btn_p17.rend());
    BOOST_TEST(17 == **btn_p22.parent());
    BOOST_TEST(!btn_p22.left());
    BOOST_TEST(!btn_p22.right());
    BOOST_TEST(btn_p22.begin() == btn_p22.end());
    BOOST_TEST(btn_p22.rbegin() == btn_p22.rend());
    BOOST_TEST(13 == **btn_p25.parent());
    BOOST_TEST(17 == **btn_p25.left());
    BOOST_TEST(27 == **btn_p25.right());
    BOOST_TEST(17 == **btn_p25.begin());
    BOOST_TEST(27 == **(btn_p25.begin() + 1));
    BOOST_TEST(btn_p25.begin() + 2 == btn_p25.end());
    BOOST_TEST(27 == **btn_p25.rbegin());
    BOOST_TEST(17 == **(btn_p25.rbegin() + 1));
    BOOST_TEST(btn_p25.rbegin() + 2 == btn_p25.rend());
    BOOST_TEST(25 == **btn_p27.parent());
    BOOST_TEST(!btn_p27.left());
    BOOST_TEST(!btn_p27.right());
    BOOST_TEST(btn_p27.begin() == btn_p27.end());
    BOOST_TEST(btn_p27.rbegin() == btn_p27.rend());
    bft_fwd_itr = ::odds_and_ends::node::make_breadth_first_tree_iterator(btn_p13);
    BOOST_TEST(13 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(6 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(25 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(1 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(8 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(17 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(27 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(11 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(15 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(22 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(!bft_fwd_itr);
    bft_bkd_itr = ::odds_and_ends::node::make_breadth_first_tree_iterator<
        ::boost::mpl::true_
    >(btn_p13);
    BOOST_TEST(13 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(25 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(6 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(27 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(17 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(8 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(1 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(22 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(15 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(11 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(!bft_bkd_itr);
    btn_p25.swap(btn_p17);
    BOOST_TEST(17 == **btn_p13.right());
    BOOST_TEST(17 == **btn_p25.parent());
    BOOST_TEST(15 == **btn_p25.left());
    BOOST_TEST(22 == **btn_p25.right());
    BOOST_TEST(13 == **btn_p17.parent());
    BOOST_TEST(25 == **btn_p17.left());
    BOOST_TEST(27 == **btn_p17.right());
    BOOST_TEST(25 == **btn_p17.begin());
    BOOST_TEST(17 == **btn_p17.begin()->parent());
    BOOST_TEST(27 == **(btn_p17.begin() + 1));
    BOOST_TEST(17 == **(btn_p17.begin() + 1)->parent());
    BOOST_TEST(btn_p17.begin() + 2 == btn_p17.end());
    BOOST_TEST(27 == **btn_p17.rbegin());
    BOOST_TEST(17 == **btn_p17.rbegin()->parent());
    BOOST_TEST(25 == **(btn_p17.rbegin() + 1));
    BOOST_TEST(17 == **(btn_p17.rbegin() + 1)->parent());
    BOOST_TEST(btn_p17.rbegin() + 2 == btn_p17.rend());
    BOOST_TEST(15 == **btn_p25.begin());
    BOOST_TEST(25 == **btn_p25.begin()->parent());
    BOOST_TEST(22 == **(btn_p25.begin() + 1));
    BOOST_TEST(25 == **(btn_p25.begin() + 1)->parent());
    BOOST_TEST(btn_p25.begin() + 2 == btn_p25.end());
    BOOST_TEST(22 == **btn_p25.rbegin());
    BOOST_TEST(25 == **btn_p25.rbegin()->parent());
    BOOST_TEST(15 == **(btn_p25.rbegin() + 1));
    BOOST_TEST(25 == **(btn_p25.rbegin() + 1)->parent());
    BOOST_TEST(btn_p25.rbegin() + 2 == btn_p25.rend());
    bft_fwd_itr = ::odds_and_ends::node::make_breadth_first_tree_iterator(btn_p13);
    BOOST_TEST(13 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(6 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(17 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(1 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(8 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(25 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(27 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(11 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(15 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(22 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(!bft_fwd_itr);
    bft_bkd_itr = ::odds_and_ends::node::make_breadth_first_tree_iterator<
        ::boost::mpl::true_
    >(btn_p13);
    BOOST_TEST(13 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(17 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(6 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(27 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(25 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(8 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(1 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(22 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(15 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(11 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(!bft_bkd_itr);
    btn_p25.swap(btn_p17);
    BOOST_TEST(25 == **btn_p13.right());
    BOOST_TEST(25 == **btn_p17.parent());
    BOOST_TEST(15 == **btn_p17.left());
    BOOST_TEST(22 == **btn_p17.right());
    BOOST_TEST(13 == **btn_p25.parent());
    BOOST_TEST(17 == **btn_p25.left());
    BOOST_TEST(27 == **btn_p25.right());
    BOOST_TEST(15 == **btn_p17.begin());
    BOOST_TEST(17 == **btn_p17.begin()->parent());
    BOOST_TEST(22 == **(btn_p17.begin() + 1));
    BOOST_TEST(17 == **(btn_p17.begin() + 1)->parent());
    BOOST_TEST(btn_p17.begin() + 2 == btn_p17.end());
    BOOST_TEST(22 == **btn_p17.rbegin());
    BOOST_TEST(17 == **btn_p17.rbegin()->parent());
    BOOST_TEST(15 == **(btn_p17.rbegin() + 1));
    BOOST_TEST(17 == **(btn_p17.rbegin() + 1)->parent());
    BOOST_TEST(btn_p17.rbegin() + 2 == btn_p17.rend());
    BOOST_TEST(17 == **btn_p25.begin());
    BOOST_TEST(25 == **btn_p25.begin()->parent());
    BOOST_TEST(27 == **(btn_p25.begin() + 1));
    BOOST_TEST(25 == **(btn_p25.begin() + 1)->parent());
    BOOST_TEST(btn_p25.begin() + 2 == btn_p25.end());
    BOOST_TEST(27 == **btn_p25.rbegin());
    BOOST_TEST(25 == **btn_p25.rbegin()->parent());
    BOOST_TEST(17 == **(btn_p25.rbegin() + 1));
    BOOST_TEST(25 == **(btn_p25.rbegin() + 1)->parent());
    BOOST_TEST(btn_p25.rbegin() + 2 == btn_p25.rend());
    bft_fwd_itr = ::odds_and_ends::node::make_breadth_first_tree_iterator(btn_p13);
    BOOST_TEST(13 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(6 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(25 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(1 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(8 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(17 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(27 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(11 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(15 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(22 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(!bft_fwd_itr);
    bft_bkd_itr = ::odds_and_ends::node::make_breadth_first_tree_iterator<
        ::boost::mpl::true_
    >(btn_p13);
    BOOST_TEST(13 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(25 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(6 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(27 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(17 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(8 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(1 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(22 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(15 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(11 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(!bft_bkd_itr);
    rotate_result = btn_p06.rotate_left();
    BOOST_TEST(8 == **rotate_result);
    BOOST_TEST(6 == **btn_p01.parent());
    BOOST_TEST(btn_p01.begin() == btn_p01.end());
    BOOST_TEST(btn_p01.rbegin() == btn_p01.rend());
    BOOST_TEST(8 == **btn_p06.parent());
    BOOST_TEST(1 == **btn_p06.left());
    BOOST_TEST(1 == **btn_p06.begin());
    BOOST_TEST(btn_p06.begin() + 1 == btn_p06.end());
    BOOST_TEST(1 == **btn_p06.rbegin());
    BOOST_TEST(btn_p06.rbegin() + 1 == btn_p06.rend());
    BOOST_TEST(13 == **btn_p08.parent());
    BOOST_TEST(11 == **btn_p08.right());
    BOOST_TEST(6 == **btn_p08.begin());
    BOOST_TEST(11 == **(btn_p08.begin() + 1));
    BOOST_TEST(btn_p08.begin() + 2 == btn_p08.end());
    BOOST_TEST(11 == **btn_p08.rbegin());
    BOOST_TEST(6 == **(btn_p08.rbegin() + 1));
    BOOST_TEST(btn_p08.rbegin() + 2 == btn_p08.rend());
    BOOST_TEST(8 == **btn_p11.parent());
    BOOST_TEST(!btn_p11.left());
    BOOST_TEST(!btn_p11.right());
    BOOST_TEST(btn_p11.begin() == btn_p11.end());
    BOOST_TEST(btn_p11.rbegin() == btn_p11.rend());
    BOOST_TEST(!btn_p13.parent());
    BOOST_TEST(8 == **btn_p13.left());
    BOOST_TEST(25 == **btn_p13.right());
    BOOST_TEST(8 == **btn_p13.begin());
    BOOST_TEST(25 == **(btn_p13.begin() + 1));
    BOOST_TEST(btn_p13.begin() + 2 == btn_p13.end());
    BOOST_TEST(25 == **btn_p13.rbegin());
    BOOST_TEST(8 == **(btn_p13.rbegin() + 1));
    BOOST_TEST(btn_p13.rbegin() + 2 == btn_p13.rend());
    BOOST_TEST(17 == **btn_p15.parent());
    BOOST_TEST(!btn_p15.left());
    BOOST_TEST(!btn_p15.right());
    BOOST_TEST(btn_p15.begin() == btn_p15.end());
    BOOST_TEST(btn_p15.rbegin() == btn_p15.rend());
    BOOST_TEST(25 == **btn_p17.parent());
    BOOST_TEST(15 == **btn_p17.left());
    BOOST_TEST(22 == **btn_p17.right());
    BOOST_TEST(15 == **btn_p17.begin());
    BOOST_TEST(22 == **(btn_p17.begin() + 1));
    BOOST_TEST(btn_p17.begin() + 2 == btn_p17.end());
    BOOST_TEST(22 == **btn_p17.rbegin());
    BOOST_TEST(15 == **(btn_p17.rbegin() + 1));
    BOOST_TEST(btn_p17.rbegin() + 2 == btn_p17.rend());
    BOOST_TEST(17 == **btn_p22.parent());
    BOOST_TEST(!btn_p22.left());
    BOOST_TEST(!btn_p22.right());
    BOOST_TEST(btn_p22.begin() == btn_p22.end());
    BOOST_TEST(btn_p22.rbegin() == btn_p22.rend());
    BOOST_TEST(13 == **btn_p25.parent());
    BOOST_TEST(17 == **btn_p25.left());
    BOOST_TEST(27 == **btn_p25.right());
    BOOST_TEST(17 == **btn_p25.begin());
    BOOST_TEST(27 == **(btn_p25.begin() + 1));
    BOOST_TEST(btn_p25.begin() + 2 == btn_p25.end());
    BOOST_TEST(27 == **btn_p25.rbegin());
    BOOST_TEST(17 == **(btn_p25.rbegin() + 1));
    BOOST_TEST(btn_p25.rbegin() + 2 == btn_p25.rend());
    BOOST_TEST(25 == **btn_p27.parent());
    BOOST_TEST(!btn_p27.left());
    BOOST_TEST(!btn_p27.right());
    BOOST_TEST(btn_p27.begin() == btn_p27.end());
    BOOST_TEST(btn_p27.rbegin() == btn_p27.rend());
    bft_fwd_itr = ::odds_and_ends::node::make_breadth_first_tree_iterator(btn_p13);
    BOOST_TEST(13 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(8 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(25 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(6 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(11 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(17 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(27 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(1 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(15 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(22 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(!bft_fwd_itr);
    bft_bkd_itr = ::odds_and_ends::node::make_breadth_first_tree_iterator<
        ::boost::mpl::true_
    >(btn_p13);
    BOOST_TEST(13 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(25 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(8 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(27 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(17 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(11 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(6 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(22 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(15 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(1 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(!bft_bkd_itr);
    rotate_result = btn_p25.rotate_right();
    BOOST_TEST(17 == **rotate_result);
    BOOST_TEST(6 == **btn_p01.parent());
    BOOST_TEST(btn_p01.begin() == btn_p01.end());
    BOOST_TEST(btn_p01.rbegin() == btn_p01.rend());
    BOOST_TEST(8 == **btn_p06.parent());
    BOOST_TEST(1 == **btn_p06.left());
    BOOST_TEST(1 == **btn_p06.begin());
    BOOST_TEST(btn_p06.begin() + 1 == btn_p06.end());
    BOOST_TEST(1 == **btn_p06.rbegin());
    BOOST_TEST(btn_p06.rbegin() + 1 == btn_p06.rend());
    BOOST_TEST(13 == **btn_p08.parent());
    BOOST_TEST(11 == **btn_p08.right());
    BOOST_TEST(6 == **btn_p08.begin());
    BOOST_TEST(11 == **(btn_p08.begin() + 1));
    BOOST_TEST(btn_p08.begin() + 2 == btn_p08.end());
    BOOST_TEST(11 == **btn_p08.rbegin());
    BOOST_TEST(6 == **(btn_p08.rbegin() + 1));
    BOOST_TEST(btn_p08.rbegin() + 2 == btn_p08.rend());
    BOOST_TEST(8 == **btn_p11.parent());
    BOOST_TEST(!btn_p11.left());
    BOOST_TEST(!btn_p11.right());
    BOOST_TEST(btn_p11.begin() == btn_p11.end());
    BOOST_TEST(btn_p11.rbegin() == btn_p11.rend());
    BOOST_TEST(!btn_p13.parent());
    BOOST_TEST(8 == **btn_p13.left());
    BOOST_TEST(17 == **btn_p13.right());
    BOOST_TEST(8 == **btn_p13.begin());
    BOOST_TEST(17 == **(btn_p13.begin() + 1));
    BOOST_TEST(btn_p13.begin() + 2 == btn_p13.end());
    BOOST_TEST(17 == **btn_p13.rbegin());
    BOOST_TEST(8 == **(btn_p13.rbegin() + 1));
    BOOST_TEST(btn_p13.rbegin() + 2 == btn_p13.rend());
    BOOST_TEST(17 == **btn_p15.parent());
    BOOST_TEST(!btn_p15.left());
    BOOST_TEST(!btn_p15.right());
    BOOST_TEST(btn_p15.begin() == btn_p15.end());
    BOOST_TEST(btn_p15.rbegin() == btn_p15.rend());
    BOOST_TEST(13 == **btn_p17.parent());
    BOOST_TEST(15 == **btn_p17.left());
    BOOST_TEST(25 == **btn_p17.right());
    BOOST_TEST(15 == **btn_p17.begin());
    BOOST_TEST(25 == **(btn_p17.begin() + 1));
    BOOST_TEST(btn_p17.begin() + 2 == btn_p17.end());
    BOOST_TEST(25 == **btn_p17.rbegin());
    BOOST_TEST(15 == **(btn_p17.rbegin() + 1));
    BOOST_TEST(btn_p17.rbegin() + 2 == btn_p17.rend());
    BOOST_TEST(25 == **btn_p22.parent());
    BOOST_TEST(!btn_p22.left());
    BOOST_TEST(!btn_p22.right());
    BOOST_TEST(btn_p22.begin() == btn_p22.end());
    BOOST_TEST(btn_p22.rbegin() == btn_p22.rend());
    BOOST_TEST(17 == **btn_p25.parent());
    BOOST_TEST(22 == **btn_p25.left());
    BOOST_TEST(27 == **btn_p25.right());
    BOOST_TEST(22 == **btn_p25.begin());
    BOOST_TEST(27 == **(btn_p25.begin() + 1));
    BOOST_TEST(btn_p25.begin() + 2 == btn_p25.end());
    BOOST_TEST(27 == **btn_p25.rbegin());
    BOOST_TEST(22 == **(btn_p25.rbegin() + 1));
    BOOST_TEST(btn_p25.rbegin() + 2 == btn_p25.rend());
    BOOST_TEST(25 == **btn_p27.parent());
    BOOST_TEST(!btn_p27.left());
    BOOST_TEST(!btn_p27.right());
    BOOST_TEST(btn_p27.begin() == btn_p27.end());
    BOOST_TEST(btn_p27.rbegin() == btn_p27.rend());
    bft_fwd_itr = ::odds_and_ends::node::make_breadth_first_tree_iterator(btn_p13);
    BOOST_TEST(13 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(8 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(17 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(6 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(11 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(15 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(25 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(1 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(22 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(27 == **bft_fwd_itr);
    ++bft_fwd_itr;
    BOOST_TEST(!bft_fwd_itr);
    bft_bkd_itr = ::odds_and_ends::node::make_breadth_first_tree_iterator<
        ::boost::mpl::true_
    >(btn_p13);
    BOOST_TEST(13 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(17 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(8 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(25 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(15 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(11 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(6 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(27 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(22 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(1 == **bft_bkd_itr);
    ++bft_bkd_itr;
    BOOST_TEST(!bft_bkd_itr);
}

#include <odds_and_ends/node/tree/associative.hpp>

typedef ::odds_and_ends::composite_type::composite_type<
    ::boost::mpl::deque<
        ::odds_and_ends::node::data<int const>,
        ::odds_and_ends::node::tree::base<>,
        ::odds_and_ends::node::tree::associative<char>
    >
> associative_tree_node;

void test_02()
{
    associative_tree_node atn_n03(-3);
    associative_tree_node atn_n02(-2);
    associative_tree_node atn_n01(-1);
    associative_tree_node atn_o00(0);
    associative_tree_node atn_p01(1);
    associative_tree_node atn_p02(2);
    associative_tree_node atn_p03(3);
    associative_tree_node atn_p04(4);
    associative_tree_node atn_p05(5);
    associative_tree_node atn_p06(6);
    associative_tree_node atn_p07(7);
    associative_tree_node atn_p08(8);
    associative_tree_node atn_p09(9);
    associative_tree_node atn_p10(10);
    associative_tree_node atn_p11(11);
    associative_tree_node atn_p12(12);
    associative_tree_node atn_p13(13);

    BOOST_TEST(-3 == *atn_n03);
    BOOST_TEST(!atn_n03.parent());
    BOOST_TEST(atn_n03.cbegin() == atn_n03.cend());
    BOOST_TEST(-2 == *atn_n02);
    BOOST_TEST(!atn_n02.parent());
    BOOST_TEST(atn_n02.cbegin() == atn_n02.cend());
    BOOST_TEST(-1 == *atn_n01);
    BOOST_TEST(!atn_n01.parent());
    BOOST_TEST(atn_n01.cbegin() == atn_n01.cend());
    BOOST_TEST(0 == *atn_o00);
    BOOST_TEST(!atn_o00.parent());
    BOOST_TEST(atn_o00.cbegin() == atn_o00.cend());
    BOOST_TEST(1 == *atn_p01);
    BOOST_TEST(!atn_p01.parent());
    BOOST_TEST(atn_p01.cbegin() == atn_p01.cend());
    BOOST_TEST(2 == *atn_p02);
    BOOST_TEST(!atn_p02.parent());
    BOOST_TEST(atn_p02.cbegin() == atn_p02.cend());
    BOOST_TEST(3 == *atn_p03);
    BOOST_TEST(!atn_p03.parent());
    BOOST_TEST(atn_p03.cbegin() == atn_p03.cend());
    BOOST_TEST(4 == *atn_p04);
    BOOST_TEST(!atn_p04.parent());
    BOOST_TEST(atn_p04.cbegin() == atn_p04.cend());
    BOOST_TEST(5 == *atn_p05);
    BOOST_TEST(!atn_p05.parent());
    BOOST_TEST(atn_p05.cbegin() == atn_p05.cend());
    BOOST_TEST(6 == *atn_p06);
    BOOST_TEST(!atn_p06.parent());
    BOOST_TEST(atn_p06.cbegin() == atn_p06.cend());
    BOOST_TEST(7 == *atn_p07);
    BOOST_TEST(!atn_p07.parent());
    BOOST_TEST(atn_p07.cbegin() == atn_p07.cend());
    BOOST_TEST(8 == *atn_p08);
    BOOST_TEST(!atn_p08.parent());
    BOOST_TEST(atn_p08.cbegin() == atn_p08.cend());
    BOOST_TEST(9 == *atn_p09);
    BOOST_TEST(!atn_p09.parent());
    BOOST_TEST(atn_p09.cbegin() == atn_p09.cend());
    BOOST_TEST(10 == *atn_p10);
    BOOST_TEST(!atn_p10.parent());
    BOOST_TEST(atn_p10.cbegin() == atn_p10.cend());
    BOOST_TEST(11 == *atn_p11);
    BOOST_TEST(!atn_p11.parent());
    BOOST_TEST(atn_p11.cbegin() == atn_p11.cend());
    BOOST_TEST(12 == *atn_p12);
    BOOST_TEST(!atn_p12.parent());
    BOOST_TEST(atn_p12.cbegin() == atn_p12.cend());
    BOOST_TEST(13 == *atn_p13);
    BOOST_TEST(!atn_p13.parent());
    BOOST_TEST(atn_p13.cbegin() == atn_p13.cend());

    ::odds_and_ends::node::breadth_first_tree_iterator<associative_tree_node> bft_fwd_itr(atn_o00);

    BOOST_TEST(0 == **bft_fwd_itr);
    BOOST_TEST(!bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST(!bft_fwd_itr);

    ::odds_and_ends::node::breadth_first_tree_iterator<
        associative_tree_node,
        ::boost::mpl::true_
    > bft_bkd_itr(atn_o00);

    BOOST_TEST(0 == **bft_bkd_itr);
    BOOST_TEST(!bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST(!bft_bkd_itr);
    atn_o00.set('i', atn_n03);
    BOOST_TEST('i' == atn_o00.get('i')->key());
    BOOST_TEST(-3 == **atn_o00.get('i'));
    BOOST_TEST(0 == **atn_o00.get('i')->parent());
    BOOST_TEST(0 == **atn_n03.parent());
    bft_fwd_itr = ::odds_and_ends::node::make_breadth_first_tree_iterator(atn_o00);
    BOOST_TEST(0 == **bft_fwd_itr);
    BOOST_TEST(!bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('i' == bft_fwd_itr->key());
    BOOST_TEST(-3 == **bft_fwd_itr);
    BOOST_TEST(0 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST(!bft_fwd_itr);
    bft_bkd_itr = ::odds_and_ends::node::make_breadth_first_tree_iterator<
        ::boost::mpl::true_
    >(atn_o00);
    BOOST_TEST(0 == **bft_bkd_itr);
    BOOST_TEST(!bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('i' == bft_bkd_itr->key());
    BOOST_TEST(-3 == **bft_bkd_itr);
    BOOST_TEST(0 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST(!bft_bkd_itr);
    atn_n03.set('n', atn_p07);
    BOOST_TEST('n' == atn_n03.get('n')->key());
    BOOST_TEST(7 == **atn_n03.get('n'));
    BOOST_TEST(-3 == **atn_n03.get('n')->parent());
    BOOST_TEST(-3 == **atn_p07.parent());
    bft_fwd_itr = ::odds_and_ends::node::make_breadth_first_tree_iterator(atn_o00);
    BOOST_TEST(0 == **bft_fwd_itr);
    BOOST_TEST(!bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('i' == bft_fwd_itr->key());
    BOOST_TEST(-3 == **bft_fwd_itr);
    BOOST_TEST(0 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('n' == bft_fwd_itr->key());
    BOOST_TEST(7 == **bft_fwd_itr);
    BOOST_TEST(-3 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST(!bft_fwd_itr);
    bft_bkd_itr = ::odds_and_ends::node::make_breadth_first_tree_iterator<
        ::boost::mpl::true_
    >(atn_o00);
    BOOST_TEST(0 == **bft_bkd_itr);
    BOOST_TEST(!bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('i' == bft_bkd_itr->key());
    BOOST_TEST(-3 == **bft_bkd_itr);
    BOOST_TEST(0 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('n' == bft_bkd_itr->key());
    BOOST_TEST(7 == **bft_bkd_itr);
    BOOST_TEST(-3 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST(!bft_bkd_itr);
    atn_p07.set('k', atn_p09);
    BOOST_TEST('k' == atn_p07.get('k')->key());
    BOOST_TEST(9 == **atn_p07.get('k'));
    BOOST_TEST(7 == **atn_p07.get('k')->parent());
    BOOST_TEST(7 == **atn_p09.parent());
    bft_fwd_itr = ::odds_and_ends::node::make_breadth_first_tree_iterator(atn_o00);
    BOOST_TEST(0 == **bft_fwd_itr);
    BOOST_TEST(!bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('i' == bft_fwd_itr->key());
    BOOST_TEST(-3 == **bft_fwd_itr);
    BOOST_TEST(0 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('n' == bft_fwd_itr->key());
    BOOST_TEST(7 == **bft_fwd_itr);
    BOOST_TEST(-3 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('k' == bft_fwd_itr->key());
    BOOST_TEST(9 == **bft_fwd_itr);
    BOOST_TEST(7 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST(!bft_fwd_itr);
    bft_bkd_itr = ::odds_and_ends::node::make_breadth_first_tree_iterator<
        ::boost::mpl::true_
    >(atn_o00);
    BOOST_TEST(0 == **bft_bkd_itr);
    BOOST_TEST(!bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('i' == bft_bkd_itr->key());
    BOOST_TEST(-3 == **bft_bkd_itr);
    BOOST_TEST(0 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('n' == bft_bkd_itr->key());
    BOOST_TEST(7 == **bft_bkd_itr);
    BOOST_TEST(-3 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('k' == bft_bkd_itr->key());
    BOOST_TEST(9 == **bft_bkd_itr);
    BOOST_TEST(7 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST(!bft_bkd_itr);
    atn_p07.set('n', atn_p10);
    BOOST_TEST('n' == atn_p07.get('n')->key());
    BOOST_TEST(10 == **atn_p07.get('n'));
    BOOST_TEST(7 == **atn_p07.get('n')->parent());
    BOOST_TEST(7 == **atn_p10.parent());
    bft_fwd_itr = ::odds_and_ends::node::make_breadth_first_tree_iterator(atn_o00);
    BOOST_TEST(0 == **bft_fwd_itr);
    BOOST_TEST(!bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('i' == bft_fwd_itr->key());
    BOOST_TEST(-3 == **bft_fwd_itr);
    BOOST_TEST(0 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('n' == bft_fwd_itr->key());
    BOOST_TEST(7 == **bft_fwd_itr);
    BOOST_TEST(-3 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('k' == bft_fwd_itr->key());
    BOOST_TEST(9 == **bft_fwd_itr);
    BOOST_TEST(7 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('n' == bft_fwd_itr->key());
    BOOST_TEST(10 == **bft_fwd_itr);
    BOOST_TEST(7 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST(!bft_fwd_itr);
    bft_bkd_itr = ::odds_and_ends::node::make_breadth_first_tree_iterator<
        ::boost::mpl::true_
    >(atn_o00);
    BOOST_TEST(0 == **bft_bkd_itr);
    BOOST_TEST(!bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('i' == bft_bkd_itr->key());
    BOOST_TEST(-3 == **bft_bkd_itr);
    BOOST_TEST(0 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('n' == bft_bkd_itr->key());
    BOOST_TEST(7 == **bft_bkd_itr);
    BOOST_TEST(-3 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('n' == bft_bkd_itr->key());
    BOOST_TEST(10 == **bft_bkd_itr);
    BOOST_TEST(7 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('k' == bft_bkd_itr->key());
    BOOST_TEST(9 == **bft_bkd_itr);
    BOOST_TEST(7 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST(!bft_bkd_itr);
    atn_n03.set('s', atn_p11);
    BOOST_TEST('s' == atn_n03.get('s')->key());
    BOOST_TEST(11 == **atn_n03.get('s'));
    BOOST_TEST(-3 == **atn_n03.get('s')->parent());
    BOOST_TEST(-3 == **atn_p11.parent());
    bft_fwd_itr = ::odds_and_ends::node::make_breadth_first_tree_iterator(atn_o00);
    BOOST_TEST(0 == **bft_fwd_itr);
    BOOST_TEST(!bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('i' == bft_fwd_itr->key());
    BOOST_TEST(-3 == **bft_fwd_itr);
    BOOST_TEST(0 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('n' == bft_fwd_itr->key());
    BOOST_TEST(7 == **bft_fwd_itr);
    BOOST_TEST(-3 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('s' == bft_fwd_itr->key());
    BOOST_TEST(11 == **bft_fwd_itr);
    BOOST_TEST(-3 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('k' == bft_fwd_itr->key());
    BOOST_TEST(9 == **bft_fwd_itr);
    BOOST_TEST(7 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('n' == bft_fwd_itr->key());
    BOOST_TEST(10 == **bft_fwd_itr);
    BOOST_TEST(7 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST(!bft_fwd_itr);
    bft_bkd_itr = ::odds_and_ends::node::make_breadth_first_tree_iterator<
        ::boost::mpl::true_
    >(atn_o00);
    BOOST_TEST(0 == **bft_bkd_itr);
    BOOST_TEST(!bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('i' == bft_bkd_itr->key());
    BOOST_TEST(-3 == **bft_bkd_itr);
    BOOST_TEST(0 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('s' == bft_bkd_itr->key());
    BOOST_TEST(11 == **bft_bkd_itr);
    BOOST_TEST(-3 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('n' == bft_bkd_itr->key());
    BOOST_TEST(7 == **bft_bkd_itr);
    BOOST_TEST(-3 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('n' == bft_bkd_itr->key());
    BOOST_TEST(10 == **bft_bkd_itr);
    BOOST_TEST(7 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('k' == bft_bkd_itr->key());
    BOOST_TEST(9 == **bft_bkd_itr);
    BOOST_TEST(7 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST(!bft_bkd_itr);
    atn_n03.set('t', atn_p12);
    BOOST_TEST('t' == atn_n03.get('t')->key());
    BOOST_TEST(12 == **atn_n03.get('t'));
    BOOST_TEST(-3 == **atn_n03.get('t')->parent());
    BOOST_TEST(-3 == **atn_p12.parent());
    bft_fwd_itr = ::odds_and_ends::node::make_breadth_first_tree_iterator(atn_o00);
    BOOST_TEST(0 == **bft_fwd_itr);
    BOOST_TEST(!bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('i' == bft_fwd_itr->key());
    BOOST_TEST(-3 == **bft_fwd_itr);
    BOOST_TEST(0 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('n' == bft_fwd_itr->key());
    BOOST_TEST(7 == **bft_fwd_itr);
    BOOST_TEST(-3 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('s' == bft_fwd_itr->key());
    BOOST_TEST(11 == **bft_fwd_itr);
    BOOST_TEST(-3 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('t' == bft_fwd_itr->key());
    BOOST_TEST(12 == **bft_fwd_itr);
    BOOST_TEST(-3 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('k' == bft_fwd_itr->key());
    BOOST_TEST(9 == **bft_fwd_itr);
    BOOST_TEST(7 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('n' == bft_fwd_itr->key());
    BOOST_TEST(10 == **bft_fwd_itr);
    BOOST_TEST(7 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST(!bft_fwd_itr);
    bft_bkd_itr = ::odds_and_ends::node::make_breadth_first_tree_iterator<
        ::boost::mpl::true_
    >(atn_o00);
    BOOST_TEST(0 == **bft_bkd_itr);
    BOOST_TEST(!bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('i' == bft_bkd_itr->key());
    BOOST_TEST(-3 == **bft_bkd_itr);
    BOOST_TEST(0 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('t' == bft_bkd_itr->key());
    BOOST_TEST(12 == **bft_bkd_itr);
    BOOST_TEST(-3 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('s' == bft_bkd_itr->key());
    BOOST_TEST(11 == **bft_bkd_itr);
    BOOST_TEST(-3 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('n' == bft_bkd_itr->key());
    BOOST_TEST(7 == **bft_bkd_itr);
    BOOST_TEST(-3 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('n' == bft_bkd_itr->key());
    BOOST_TEST(10 == **bft_bkd_itr);
    BOOST_TEST(7 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('k' == bft_bkd_itr->key());
    BOOST_TEST(9 == **bft_bkd_itr);
    BOOST_TEST(7 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST(!bft_bkd_itr);
    atn_o00.set('t', atn_n01);
    BOOST_TEST('t' == atn_o00.get('t')->key());
    BOOST_TEST(-1 == **atn_o00.get('t'));
    BOOST_TEST(0 == **atn_o00.get('t')->parent());
    BOOST_TEST(0 == **atn_n01.parent());
    bft_fwd_itr = ::odds_and_ends::node::make_breadth_first_tree_iterator(atn_o00);
    BOOST_TEST(0 == **bft_fwd_itr);
    BOOST_TEST(!bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('i' == bft_fwd_itr->key());
    BOOST_TEST(-3 == **bft_fwd_itr);
    BOOST_TEST(0 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('t' == bft_fwd_itr->key());
    BOOST_TEST(-1 == **bft_fwd_itr);
    BOOST_TEST(0 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('n' == bft_fwd_itr->key());
    BOOST_TEST(7 == **bft_fwd_itr);
    BOOST_TEST(-3 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('s' == bft_fwd_itr->key());
    BOOST_TEST(11 == **bft_fwd_itr);
    BOOST_TEST(-3 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('t' == bft_fwd_itr->key());
    BOOST_TEST(12 == **bft_fwd_itr);
    BOOST_TEST(-3 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('k' == bft_fwd_itr->key());
    BOOST_TEST(9 == **bft_fwd_itr);
    BOOST_TEST(7 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('n' == bft_fwd_itr->key());
    BOOST_TEST(10 == **bft_fwd_itr);
    BOOST_TEST(7 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST(!bft_fwd_itr);
    bft_bkd_itr = ::odds_and_ends::node::make_breadth_first_tree_iterator<
        ::boost::mpl::true_
    >(atn_o00);
    BOOST_TEST(0 == **bft_bkd_itr);
    BOOST_TEST(!bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('t' == bft_bkd_itr->key());
    BOOST_TEST(-1 == **bft_bkd_itr);
    BOOST_TEST(0 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('i' == bft_bkd_itr->key());
    BOOST_TEST(-3 == **bft_bkd_itr);
    BOOST_TEST(0 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('t' == bft_bkd_itr->key());
    BOOST_TEST(12 == **bft_bkd_itr);
    BOOST_TEST(-3 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('s' == bft_bkd_itr->key());
    BOOST_TEST(11 == **bft_bkd_itr);
    BOOST_TEST(-3 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('n' == bft_bkd_itr->key());
    BOOST_TEST(7 == **bft_bkd_itr);
    BOOST_TEST(-3 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('n' == bft_bkd_itr->key());
    BOOST_TEST(10 == **bft_bkd_itr);
    BOOST_TEST(7 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('k' == bft_bkd_itr->key());
    BOOST_TEST(9 == **bft_bkd_itr);
    BOOST_TEST(7 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST(!bft_bkd_itr);
    atn_n01.set('o', atn_p08);
    BOOST_TEST('o' == atn_n01.get('o')->key());
    BOOST_TEST(8 == **atn_n01.get('o'));
    BOOST_TEST(-1 == **atn_n01.get('o')->parent());
    BOOST_TEST(-1 == **atn_p08.parent());
    bft_fwd_itr = ::odds_and_ends::node::make_breadth_first_tree_iterator(atn_o00);
    BOOST_TEST(0 == **bft_fwd_itr);
    BOOST_TEST(!bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('i' == bft_fwd_itr->key());
    BOOST_TEST(-3 == **bft_fwd_itr);
    BOOST_TEST(0 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('t' == bft_fwd_itr->key());
    BOOST_TEST(-1 == **bft_fwd_itr);
    BOOST_TEST(0 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('n' == bft_fwd_itr->key());
    BOOST_TEST(7 == **bft_fwd_itr);
    BOOST_TEST(-3 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('s' == bft_fwd_itr->key());
    BOOST_TEST(11 == **bft_fwd_itr);
    BOOST_TEST(-3 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('t' == bft_fwd_itr->key());
    BOOST_TEST(12 == **bft_fwd_itr);
    BOOST_TEST(-3 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('o' == bft_fwd_itr->key());
    BOOST_TEST(8 == **bft_fwd_itr);
    BOOST_TEST(-1 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('k' == bft_fwd_itr->key());
    BOOST_TEST(9 == **bft_fwd_itr);
    BOOST_TEST(7 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('n' == bft_fwd_itr->key());
    BOOST_TEST(10 == **bft_fwd_itr);
    BOOST_TEST(7 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST(!bft_fwd_itr);
    bft_bkd_itr = ::odds_and_ends::node::make_breadth_first_tree_iterator<
        ::boost::mpl::true_
    >(atn_o00);
    BOOST_TEST(0 == **bft_bkd_itr);
    BOOST_TEST(!bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('t' == bft_bkd_itr->key());
    BOOST_TEST(-1 == **bft_bkd_itr);
    BOOST_TEST(0 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('i' == bft_bkd_itr->key());
    BOOST_TEST(-3 == **bft_bkd_itr);
    BOOST_TEST(0 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('o' == bft_bkd_itr->key());
    BOOST_TEST(8 == **bft_bkd_itr);
    BOOST_TEST(-1 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('t' == bft_bkd_itr->key());
    BOOST_TEST(12 == **bft_bkd_itr);
    BOOST_TEST(-3 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('s' == bft_bkd_itr->key());
    BOOST_TEST(11 == **bft_bkd_itr);
    BOOST_TEST(-3 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('n' == bft_bkd_itr->key());
    BOOST_TEST(7 == **bft_bkd_itr);
    BOOST_TEST(-3 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('n' == bft_bkd_itr->key());
    BOOST_TEST(10 == **bft_bkd_itr);
    BOOST_TEST(7 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('k' == bft_bkd_itr->key());
    BOOST_TEST(9 == **bft_bkd_itr);
    BOOST_TEST(7 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST(!bft_bkd_itr);
    atn_n01.set('e', atn_n02);
    BOOST_TEST('e' == atn_n01.get('e')->key());
    BOOST_TEST(-2 == **atn_n01.get('e'));
    BOOST_TEST(-1 == **atn_n01.get('e')->parent());
    BOOST_TEST(-1 == **atn_n02.parent());
    bft_fwd_itr = ::odds_and_ends::node::make_breadth_first_tree_iterator(atn_o00);
    BOOST_TEST(0 == **bft_fwd_itr);
    BOOST_TEST(!bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('i' == bft_fwd_itr->key());
    BOOST_TEST(-3 == **bft_fwd_itr);
    BOOST_TEST(0 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('t' == bft_fwd_itr->key());
    BOOST_TEST(-1 == **bft_fwd_itr);
    BOOST_TEST(0 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('n' == bft_fwd_itr->key());
    BOOST_TEST(7 == **bft_fwd_itr);
    BOOST_TEST(-3 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('s' == bft_fwd_itr->key());
    BOOST_TEST(11 == **bft_fwd_itr);
    BOOST_TEST(-3 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('t' == bft_fwd_itr->key());
    BOOST_TEST(12 == **bft_fwd_itr);
    BOOST_TEST(-3 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('e' == bft_fwd_itr->key());
    BOOST_TEST(-2 == **bft_fwd_itr);
    BOOST_TEST(-1 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('o' == bft_fwd_itr->key());
    BOOST_TEST(8 == **bft_fwd_itr);
    BOOST_TEST(-1 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('k' == bft_fwd_itr->key());
    BOOST_TEST(9 == **bft_fwd_itr);
    BOOST_TEST(7 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('n' == bft_fwd_itr->key());
    BOOST_TEST(10 == **bft_fwd_itr);
    BOOST_TEST(7 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST(!bft_fwd_itr);
    bft_bkd_itr = ::odds_and_ends::node::make_breadth_first_tree_iterator<
        ::boost::mpl::true_
    >(atn_o00);
    BOOST_TEST(0 == **bft_bkd_itr);
    BOOST_TEST(!bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('t' == bft_bkd_itr->key());
    BOOST_TEST(-1 == **bft_bkd_itr);
    BOOST_TEST(0 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('i' == bft_bkd_itr->key());
    BOOST_TEST(-3 == **bft_bkd_itr);
    BOOST_TEST(0 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('o' == bft_bkd_itr->key());
    BOOST_TEST(8 == **bft_bkd_itr);
    BOOST_TEST(-1 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('e' == bft_bkd_itr->key());
    BOOST_TEST(-2 == **bft_bkd_itr);
    BOOST_TEST(-1 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('t' == bft_bkd_itr->key());
    BOOST_TEST(12 == **bft_bkd_itr);
    BOOST_TEST(-3 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('s' == bft_bkd_itr->key());
    BOOST_TEST(11 == **bft_bkd_itr);
    BOOST_TEST(-3 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('n' == bft_bkd_itr->key());
    BOOST_TEST(7 == **bft_bkd_itr);
    BOOST_TEST(-3 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('n' == bft_bkd_itr->key());
    BOOST_TEST(10 == **bft_bkd_itr);
    BOOST_TEST(7 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('k' == bft_bkd_itr->key());
    BOOST_TEST(9 == **bft_bkd_itr);
    BOOST_TEST(7 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST(!bft_bkd_itr);
    atn_n02.set('d', atn_p05);
    BOOST_TEST('d' == atn_n02.get('d')->key());
    BOOST_TEST(5 == **atn_n02.get('d'));
    BOOST_TEST(-2 == **atn_n02.get('d')->parent());
    BOOST_TEST(-2 == **atn_p05.parent());
    bft_fwd_itr = ::odds_and_ends::node::make_breadth_first_tree_iterator(atn_o00);
    BOOST_TEST(0 == **bft_fwd_itr);
    BOOST_TEST(!bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('i' == bft_fwd_itr->key());
    BOOST_TEST(-3 == **bft_fwd_itr);
    BOOST_TEST(0 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('t' == bft_fwd_itr->key());
    BOOST_TEST(-1 == **bft_fwd_itr);
    BOOST_TEST(0 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('n' == bft_fwd_itr->key());
    BOOST_TEST(7 == **bft_fwd_itr);
    BOOST_TEST(-3 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('s' == bft_fwd_itr->key());
    BOOST_TEST(11 == **bft_fwd_itr);
    BOOST_TEST(-3 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('t' == bft_fwd_itr->key());
    BOOST_TEST(12 == **bft_fwd_itr);
    BOOST_TEST(-3 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('e' == bft_fwd_itr->key());
    BOOST_TEST(-2 == **bft_fwd_itr);
    BOOST_TEST(-1 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('o' == bft_fwd_itr->key());
    BOOST_TEST(8 == **bft_fwd_itr);
    BOOST_TEST(-1 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('k' == bft_fwd_itr->key());
    BOOST_TEST(9 == **bft_fwd_itr);
    BOOST_TEST(7 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('n' == bft_fwd_itr->key());
    BOOST_TEST(10 == **bft_fwd_itr);
    BOOST_TEST(7 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('d' == bft_fwd_itr->key());
    BOOST_TEST(5 == **bft_fwd_itr);
    BOOST_TEST(-2 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST(!bft_fwd_itr);
    bft_bkd_itr = ::odds_and_ends::node::make_breadth_first_tree_iterator<
        ::boost::mpl::true_
    >(atn_o00);
    BOOST_TEST(0 == **bft_bkd_itr);
    BOOST_TEST(!bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('t' == bft_bkd_itr->key());
    BOOST_TEST(-1 == **bft_bkd_itr);
    BOOST_TEST(0 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('i' == bft_bkd_itr->key());
    BOOST_TEST(-3 == **bft_bkd_itr);
    BOOST_TEST(0 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('o' == bft_bkd_itr->key());
    BOOST_TEST(8 == **bft_bkd_itr);
    BOOST_TEST(-1 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('e' == bft_bkd_itr->key());
    BOOST_TEST(-2 == **bft_bkd_itr);
    BOOST_TEST(-1 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('t' == bft_bkd_itr->key());
    BOOST_TEST(12 == **bft_bkd_itr);
    BOOST_TEST(-3 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('s' == bft_bkd_itr->key());
    BOOST_TEST(11 == **bft_bkd_itr);
    BOOST_TEST(-3 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('n' == bft_bkd_itr->key());
    BOOST_TEST(7 == **bft_bkd_itr);
    BOOST_TEST(-3 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('d' == bft_bkd_itr->key());
    BOOST_TEST(5 == **bft_bkd_itr);
    BOOST_TEST(-2 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('n' == bft_bkd_itr->key());
    BOOST_TEST(10 == **bft_bkd_itr);
    BOOST_TEST(7 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('k' == bft_bkd_itr->key());
    BOOST_TEST(9 == **bft_bkd_itr);
    BOOST_TEST(7 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST(!bft_bkd_itr);
    atn_n02.set('n', atn_p06);
    BOOST_TEST('n' == atn_n02.get('n')->key());
    BOOST_TEST(6 == **atn_n02.get('n'));
    BOOST_TEST(-2 == **atn_n02.get('n')->parent());
    BOOST_TEST(-2 == **atn_p06.parent());
    bft_fwd_itr = ::odds_and_ends::node::make_breadth_first_tree_iterator(atn_o00);
    BOOST_TEST(0 == **bft_fwd_itr);
    BOOST_TEST(!bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('i' == bft_fwd_itr->key());
    BOOST_TEST(-3 == **bft_fwd_itr);
    BOOST_TEST(0 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('t' == bft_fwd_itr->key());
    BOOST_TEST(-1 == **bft_fwd_itr);
    BOOST_TEST(0 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('n' == bft_fwd_itr->key());
    BOOST_TEST(7 == **bft_fwd_itr);
    BOOST_TEST(-3 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('s' == bft_fwd_itr->key());
    BOOST_TEST(11 == **bft_fwd_itr);
    BOOST_TEST(-3 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('t' == bft_fwd_itr->key());
    BOOST_TEST(12 == **bft_fwd_itr);
    BOOST_TEST(-3 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('e' == bft_fwd_itr->key());
    BOOST_TEST(-2 == **bft_fwd_itr);
    BOOST_TEST(-1 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('o' == bft_fwd_itr->key());
    BOOST_TEST(8 == **bft_fwd_itr);
    BOOST_TEST(-1 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('k' == bft_fwd_itr->key());
    BOOST_TEST(9 == **bft_fwd_itr);
    BOOST_TEST(7 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('n' == bft_fwd_itr->key());
    BOOST_TEST(10 == **bft_fwd_itr);
    BOOST_TEST(7 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('d' == bft_fwd_itr->key());
    BOOST_TEST(5 == **bft_fwd_itr);
    BOOST_TEST(-2 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('n' == bft_fwd_itr->key());
    BOOST_TEST(6 == **bft_fwd_itr);
    BOOST_TEST(-2 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST(!bft_fwd_itr);
    bft_bkd_itr = ::odds_and_ends::node::make_breadth_first_tree_iterator<
        ::boost::mpl::true_
    >(atn_o00);
    BOOST_TEST(0 == **bft_bkd_itr);
    BOOST_TEST(!bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('t' == bft_bkd_itr->key());
    BOOST_TEST(-1 == **bft_bkd_itr);
    BOOST_TEST(0 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('i' == bft_bkd_itr->key());
    BOOST_TEST(-3 == **bft_bkd_itr);
    BOOST_TEST(0 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('o' == bft_bkd_itr->key());
    BOOST_TEST(8 == **bft_bkd_itr);
    BOOST_TEST(-1 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('e' == bft_bkd_itr->key());
    BOOST_TEST(-2 == **bft_bkd_itr);
    BOOST_TEST(-1 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('t' == bft_bkd_itr->key());
    BOOST_TEST(12 == **bft_bkd_itr);
    BOOST_TEST(-3 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('s' == bft_bkd_itr->key());
    BOOST_TEST(11 == **bft_bkd_itr);
    BOOST_TEST(-3 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('n' == bft_bkd_itr->key());
    BOOST_TEST(7 == **bft_bkd_itr);
    BOOST_TEST(-3 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('n' == bft_bkd_itr->key());
    BOOST_TEST(6 == **bft_bkd_itr);
    BOOST_TEST(-2 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('d' == bft_bkd_itr->key());
    BOOST_TEST(5 == **bft_bkd_itr);
    BOOST_TEST(-2 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('n' == bft_bkd_itr->key());
    BOOST_TEST(10 == **bft_bkd_itr);
    BOOST_TEST(7 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('k' == bft_bkd_itr->key());
    BOOST_TEST(9 == **bft_bkd_itr);
    BOOST_TEST(7 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST(!bft_bkd_itr);
    atn_n02.set('a', atn_p01);
    BOOST_TEST('a' == atn_n02.get('a')->key());
    BOOST_TEST(1 == **atn_n02.get('a'));
    BOOST_TEST(-2 == **atn_n02.get('a')->parent());
    BOOST_TEST(-2 == **atn_p01.parent());
    bft_fwd_itr = ::odds_and_ends::node::make_breadth_first_tree_iterator(atn_o00);
    BOOST_TEST(0 == **bft_fwd_itr);
    BOOST_TEST(!bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('i' == bft_fwd_itr->key());
    BOOST_TEST(-3 == **bft_fwd_itr);
    BOOST_TEST(0 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('t' == bft_fwd_itr->key());
    BOOST_TEST(-1 == **bft_fwd_itr);
    BOOST_TEST(0 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('n' == bft_fwd_itr->key());
    BOOST_TEST(7 == **bft_fwd_itr);
    BOOST_TEST(-3 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('s' == bft_fwd_itr->key());
    BOOST_TEST(11 == **bft_fwd_itr);
    BOOST_TEST(-3 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('t' == bft_fwd_itr->key());
    BOOST_TEST(12 == **bft_fwd_itr);
    BOOST_TEST(-3 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('e' == bft_fwd_itr->key());
    BOOST_TEST(-2 == **bft_fwd_itr);
    BOOST_TEST(-1 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('o' == bft_fwd_itr->key());
    BOOST_TEST(8 == **bft_fwd_itr);
    BOOST_TEST(-1 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('k' == bft_fwd_itr->key());
    BOOST_TEST(9 == **bft_fwd_itr);
    BOOST_TEST(7 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('n' == bft_fwd_itr->key());
    BOOST_TEST(10 == **bft_fwd_itr);
    BOOST_TEST(7 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('a' == bft_fwd_itr->key());
    BOOST_TEST(1 == **bft_fwd_itr);
    BOOST_TEST(-2 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('d' == bft_fwd_itr->key());
    BOOST_TEST(5 == **bft_fwd_itr);
    BOOST_TEST(-2 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('n' == bft_fwd_itr->key());
    BOOST_TEST(6 == **bft_fwd_itr);
    BOOST_TEST(-2 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST(!bft_fwd_itr);
    bft_bkd_itr = ::odds_and_ends::node::make_breadth_first_tree_iterator<
        ::boost::mpl::true_
    >(atn_o00);
    BOOST_TEST(0 == **bft_bkd_itr);
    BOOST_TEST(!bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('t' == bft_bkd_itr->key());
    BOOST_TEST(-1 == **bft_bkd_itr);
    BOOST_TEST(0 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('i' == bft_bkd_itr->key());
    BOOST_TEST(-3 == **bft_bkd_itr);
    BOOST_TEST(0 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('o' == bft_bkd_itr->key());
    BOOST_TEST(8 == **bft_bkd_itr);
    BOOST_TEST(-1 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('e' == bft_bkd_itr->key());
    BOOST_TEST(-2 == **bft_bkd_itr);
    BOOST_TEST(-1 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('t' == bft_bkd_itr->key());
    BOOST_TEST(12 == **bft_bkd_itr);
    BOOST_TEST(-3 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('s' == bft_bkd_itr->key());
    BOOST_TEST(11 == **bft_bkd_itr);
    BOOST_TEST(-3 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('n' == bft_bkd_itr->key());
    BOOST_TEST(7 == **bft_bkd_itr);
    BOOST_TEST(-3 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('n' == bft_bkd_itr->key());
    BOOST_TEST(6 == **bft_bkd_itr);
    BOOST_TEST(-2 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('d' == bft_bkd_itr->key());
    BOOST_TEST(5 == **bft_bkd_itr);
    BOOST_TEST(-2 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('a' == bft_bkd_itr->key());
    BOOST_TEST(1 == **bft_bkd_itr);
    BOOST_TEST(-2 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('n' == bft_bkd_itr->key());
    BOOST_TEST(10 == **bft_bkd_itr);
    BOOST_TEST(7 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('k' == bft_bkd_itr->key());
    BOOST_TEST(9 == **bft_bkd_itr);
    BOOST_TEST(7 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST(!bft_bkd_itr);
    atn_p01.set('l', atn_p02);
    BOOST_TEST('l' == atn_p01.get('l')->key());
    BOOST_TEST(2 == **atn_p01.get('l'));
    BOOST_TEST(1 == **atn_p01.get('l')->parent());
    BOOST_TEST(1 == **atn_p02.parent());
    bft_fwd_itr = ::odds_and_ends::node::make_breadth_first_tree_iterator(atn_o00);
    BOOST_TEST(0 == **bft_fwd_itr);
    BOOST_TEST(!bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('i' == bft_fwd_itr->key());
    BOOST_TEST(-3 == **bft_fwd_itr);
    BOOST_TEST(0 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('t' == bft_fwd_itr->key());
    BOOST_TEST(-1 == **bft_fwd_itr);
    BOOST_TEST(0 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('n' == bft_fwd_itr->key());
    BOOST_TEST(7 == **bft_fwd_itr);
    BOOST_TEST(-3 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('s' == bft_fwd_itr->key());
    BOOST_TEST(11 == **bft_fwd_itr);
    BOOST_TEST(-3 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('t' == bft_fwd_itr->key());
    BOOST_TEST(12 == **bft_fwd_itr);
    BOOST_TEST(-3 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('e' == bft_fwd_itr->key());
    BOOST_TEST(-2 == **bft_fwd_itr);
    BOOST_TEST(-1 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('o' == bft_fwd_itr->key());
    BOOST_TEST(8 == **bft_fwd_itr);
    BOOST_TEST(-1 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('k' == bft_fwd_itr->key());
    BOOST_TEST(9 == **bft_fwd_itr);
    BOOST_TEST(7 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('n' == bft_fwd_itr->key());
    BOOST_TEST(10 == **bft_fwd_itr);
    BOOST_TEST(7 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('a' == bft_fwd_itr->key());
    BOOST_TEST(1 == **bft_fwd_itr);
    BOOST_TEST(-2 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('d' == bft_fwd_itr->key());
    BOOST_TEST(5 == **bft_fwd_itr);
    BOOST_TEST(-2 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('n' == bft_fwd_itr->key());
    BOOST_TEST(6 == **bft_fwd_itr);
    BOOST_TEST(-2 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('l' == bft_fwd_itr->key());
    BOOST_TEST(2 == **bft_fwd_itr);
    BOOST_TEST(1 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST(!bft_fwd_itr);
    bft_bkd_itr = ::odds_and_ends::node::make_breadth_first_tree_iterator<
        ::boost::mpl::true_
    >(atn_o00);
    BOOST_TEST(0 == **bft_bkd_itr);
    BOOST_TEST(!bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('t' == bft_bkd_itr->key());
    BOOST_TEST(-1 == **bft_bkd_itr);
    BOOST_TEST(0 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('i' == bft_bkd_itr->key());
    BOOST_TEST(-3 == **bft_bkd_itr);
    BOOST_TEST(0 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('o' == bft_bkd_itr->key());
    BOOST_TEST(8 == **bft_bkd_itr);
    BOOST_TEST(-1 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('e' == bft_bkd_itr->key());
    BOOST_TEST(-2 == **bft_bkd_itr);
    BOOST_TEST(-1 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('t' == bft_bkd_itr->key());
    BOOST_TEST(12 == **bft_bkd_itr);
    BOOST_TEST(-3 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('s' == bft_bkd_itr->key());
    BOOST_TEST(11 == **bft_bkd_itr);
    BOOST_TEST(-3 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('n' == bft_bkd_itr->key());
    BOOST_TEST(7 == **bft_bkd_itr);
    BOOST_TEST(-3 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('n' == bft_bkd_itr->key());
    BOOST_TEST(6 == **bft_bkd_itr);
    BOOST_TEST(-2 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('d' == bft_bkd_itr->key());
    BOOST_TEST(5 == **bft_bkd_itr);
    BOOST_TEST(-2 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('a' == bft_bkd_itr->key());
    BOOST_TEST(1 == **bft_bkd_itr);
    BOOST_TEST(-2 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('n' == bft_bkd_itr->key());
    BOOST_TEST(10 == **bft_bkd_itr);
    BOOST_TEST(7 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('k' == bft_bkd_itr->key());
    BOOST_TEST(9 == **bft_bkd_itr);
    BOOST_TEST(7 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('l' == bft_bkd_itr->key());
    BOOST_TEST(2 == **bft_bkd_itr);
    BOOST_TEST(1 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST(!bft_bkd_itr);
    atn_p01.set('m', atn_p03);
    BOOST_TEST('m' == atn_p01.get('m')->key());
    BOOST_TEST(3 == **atn_p01.get('m'));
    BOOST_TEST(1 == **atn_p01.get('m')->parent());
    BOOST_TEST(1 == **atn_p03.parent());
    bft_fwd_itr = ::odds_and_ends::node::make_breadth_first_tree_iterator(atn_o00);
    BOOST_TEST(0 == **bft_fwd_itr);
    BOOST_TEST(!bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('i' == bft_fwd_itr->key());
    BOOST_TEST(-3 == **bft_fwd_itr);
    BOOST_TEST(0 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('t' == bft_fwd_itr->key());
    BOOST_TEST(-1 == **bft_fwd_itr);
    BOOST_TEST(0 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('n' == bft_fwd_itr->key());
    BOOST_TEST(7 == **bft_fwd_itr);
    BOOST_TEST(-3 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('s' == bft_fwd_itr->key());
    BOOST_TEST(11 == **bft_fwd_itr);
    BOOST_TEST(-3 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('t' == bft_fwd_itr->key());
    BOOST_TEST(12 == **bft_fwd_itr);
    BOOST_TEST(-3 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('e' == bft_fwd_itr->key());
    BOOST_TEST(-2 == **bft_fwd_itr);
    BOOST_TEST(-1 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('o' == bft_fwd_itr->key());
    BOOST_TEST(8 == **bft_fwd_itr);
    BOOST_TEST(-1 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('k' == bft_fwd_itr->key());
    BOOST_TEST(9 == **bft_fwd_itr);
    BOOST_TEST(7 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('n' == bft_fwd_itr->key());
    BOOST_TEST(10 == **bft_fwd_itr);
    BOOST_TEST(7 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('a' == bft_fwd_itr->key());
    BOOST_TEST(1 == **bft_fwd_itr);
    BOOST_TEST(-2 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('d' == bft_fwd_itr->key());
    BOOST_TEST(5 == **bft_fwd_itr);
    BOOST_TEST(-2 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('n' == bft_fwd_itr->key());
    BOOST_TEST(6 == **bft_fwd_itr);
    BOOST_TEST(-2 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('l' == bft_fwd_itr->key());
    BOOST_TEST(2 == **bft_fwd_itr);
    BOOST_TEST(1 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('m' == bft_fwd_itr->key());
    BOOST_TEST(3 == **bft_fwd_itr);
    BOOST_TEST(1 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST(!bft_fwd_itr);
    bft_bkd_itr = ::odds_and_ends::node::make_breadth_first_tree_iterator<
        ::boost::mpl::true_
    >(atn_o00);
    BOOST_TEST(0 == **bft_bkd_itr);
    BOOST_TEST(!bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('t' == bft_bkd_itr->key());
    BOOST_TEST(-1 == **bft_bkd_itr);
    BOOST_TEST(0 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('i' == bft_bkd_itr->key());
    BOOST_TEST(-3 == **bft_bkd_itr);
    BOOST_TEST(0 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('o' == bft_bkd_itr->key());
    BOOST_TEST(8 == **bft_bkd_itr);
    BOOST_TEST(-1 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('e' == bft_bkd_itr->key());
    BOOST_TEST(-2 == **bft_bkd_itr);
    BOOST_TEST(-1 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('t' == bft_bkd_itr->key());
    BOOST_TEST(12 == **bft_bkd_itr);
    BOOST_TEST(-3 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('s' == bft_bkd_itr->key());
    BOOST_TEST(11 == **bft_bkd_itr);
    BOOST_TEST(-3 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('n' == bft_bkd_itr->key());
    BOOST_TEST(7 == **bft_bkd_itr);
    BOOST_TEST(-3 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('n' == bft_bkd_itr->key());
    BOOST_TEST(6 == **bft_bkd_itr);
    BOOST_TEST(-2 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('d' == bft_bkd_itr->key());
    BOOST_TEST(5 == **bft_bkd_itr);
    BOOST_TEST(-2 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('a' == bft_bkd_itr->key());
    BOOST_TEST(1 == **bft_bkd_itr);
    BOOST_TEST(-2 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('n' == bft_bkd_itr->key());
    BOOST_TEST(10 == **bft_bkd_itr);
    BOOST_TEST(7 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('k' == bft_bkd_itr->key());
    BOOST_TEST(9 == **bft_bkd_itr);
    BOOST_TEST(7 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('m' == bft_bkd_itr->key());
    BOOST_TEST(3 == **bft_bkd_itr);
    BOOST_TEST(1 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('l' == bft_bkd_itr->key());
    BOOST_TEST(2 == **bft_bkd_itr);
    BOOST_TEST(1 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST(!bft_bkd_itr);
    atn_p01.set('r', atn_p04);
    BOOST_TEST('r' == atn_p01.get('r')->key());
    BOOST_TEST(4 == **atn_p01.get('r'));
    BOOST_TEST(1 == **atn_p01.get('r')->parent());
    BOOST_TEST(1 == **atn_p04.parent());
    bft_fwd_itr = ::odds_and_ends::node::make_breadth_first_tree_iterator(atn_o00);
    BOOST_TEST(0 == **bft_fwd_itr);
    BOOST_TEST(!bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('i' == bft_fwd_itr->key());
    BOOST_TEST(-3 == **bft_fwd_itr);
    BOOST_TEST(0 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('t' == bft_fwd_itr->key());
    BOOST_TEST(-1 == **bft_fwd_itr);
    BOOST_TEST(0 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('n' == bft_fwd_itr->key());
    BOOST_TEST(7 == **bft_fwd_itr);
    BOOST_TEST(-3 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('s' == bft_fwd_itr->key());
    BOOST_TEST(11 == **bft_fwd_itr);
    BOOST_TEST(-3 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('t' == bft_fwd_itr->key());
    BOOST_TEST(12 == **bft_fwd_itr);
    BOOST_TEST(-3 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('e' == bft_fwd_itr->key());
    BOOST_TEST(-2 == **bft_fwd_itr);
    BOOST_TEST(-1 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('o' == bft_fwd_itr->key());
    BOOST_TEST(8 == **bft_fwd_itr);
    BOOST_TEST(-1 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('k' == bft_fwd_itr->key());
    BOOST_TEST(9 == **bft_fwd_itr);
    BOOST_TEST(7 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('n' == bft_fwd_itr->key());
    BOOST_TEST(10 == **bft_fwd_itr);
    BOOST_TEST(7 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('a' == bft_fwd_itr->key());
    BOOST_TEST(1 == **bft_fwd_itr);
    BOOST_TEST(-2 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('d' == bft_fwd_itr->key());
    BOOST_TEST(5 == **bft_fwd_itr);
    BOOST_TEST(-2 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('n' == bft_fwd_itr->key());
    BOOST_TEST(6 == **bft_fwd_itr);
    BOOST_TEST(-2 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('l' == bft_fwd_itr->key());
    BOOST_TEST(2 == **bft_fwd_itr);
    BOOST_TEST(1 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('m' == bft_fwd_itr->key());
    BOOST_TEST(3 == **bft_fwd_itr);
    BOOST_TEST(1 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('r' == bft_fwd_itr->key());
    BOOST_TEST(4 == **bft_fwd_itr);
    BOOST_TEST(1 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST(!bft_fwd_itr);
    bft_bkd_itr = ::odds_and_ends::node::make_breadth_first_tree_iterator<
        ::boost::mpl::true_
    >(atn_o00);
    BOOST_TEST(0 == **bft_bkd_itr);
    BOOST_TEST(!bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('t' == bft_bkd_itr->key());
    BOOST_TEST(-1 == **bft_bkd_itr);
    BOOST_TEST(0 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('i' == bft_bkd_itr->key());
    BOOST_TEST(-3 == **bft_bkd_itr);
    BOOST_TEST(0 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('o' == bft_bkd_itr->key());
    BOOST_TEST(8 == **bft_bkd_itr);
    BOOST_TEST(-1 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('e' == bft_bkd_itr->key());
    BOOST_TEST(-2 == **bft_bkd_itr);
    BOOST_TEST(-1 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('t' == bft_bkd_itr->key());
    BOOST_TEST(12 == **bft_bkd_itr);
    BOOST_TEST(-3 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('s' == bft_bkd_itr->key());
    BOOST_TEST(11 == **bft_bkd_itr);
    BOOST_TEST(-3 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('n' == bft_bkd_itr->key());
    BOOST_TEST(7 == **bft_bkd_itr);
    BOOST_TEST(-3 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('n' == bft_bkd_itr->key());
    BOOST_TEST(6 == **bft_bkd_itr);
    BOOST_TEST(-2 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('d' == bft_bkd_itr->key());
    BOOST_TEST(5 == **bft_bkd_itr);
    BOOST_TEST(-2 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('a' == bft_bkd_itr->key());
    BOOST_TEST(1 == **bft_bkd_itr);
    BOOST_TEST(-2 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('n' == bft_bkd_itr->key());
    BOOST_TEST(10 == **bft_bkd_itr);
    BOOST_TEST(7 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('k' == bft_bkd_itr->key());
    BOOST_TEST(9 == **bft_bkd_itr);
    BOOST_TEST(7 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('r' == bft_bkd_itr->key());
    BOOST_TEST(4 == **bft_bkd_itr);
    BOOST_TEST(1 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('m' == bft_bkd_itr->key());
    BOOST_TEST(3 == **bft_bkd_itr);
    BOOST_TEST(1 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('l' == bft_bkd_itr->key());
    BOOST_TEST(2 == **bft_bkd_itr);
    BOOST_TEST(1 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST(!bft_bkd_itr);
    atn_o00.set('A', atn_p13);
    BOOST_TEST('A' == atn_o00.get('A')->key());
    BOOST_TEST(13 == **atn_o00.get('A'));
    BOOST_TEST(0 == **atn_o00.get('A')->parent());
    BOOST_TEST(0 == **atn_p13.parent());
    bft_fwd_itr = ::odds_and_ends::node::make_breadth_first_tree_iterator(atn_o00);
    BOOST_TEST(0 == **bft_fwd_itr);
    BOOST_TEST(!bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('A' == bft_fwd_itr->key());
    BOOST_TEST(13 == **bft_fwd_itr);
    BOOST_TEST(0 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('i' == bft_fwd_itr->key());
    BOOST_TEST(-3 == **bft_fwd_itr);
    BOOST_TEST(0 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('t' == bft_fwd_itr->key());
    BOOST_TEST(-1 == **bft_fwd_itr);
    BOOST_TEST(0 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('n' == bft_fwd_itr->key());
    BOOST_TEST(7 == **bft_fwd_itr);
    BOOST_TEST(-3 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('s' == bft_fwd_itr->key());
    BOOST_TEST(11 == **bft_fwd_itr);
    BOOST_TEST(-3 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('t' == bft_fwd_itr->key());
    BOOST_TEST(12 == **bft_fwd_itr);
    BOOST_TEST(-3 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('e' == bft_fwd_itr->key());
    BOOST_TEST(-2 == **bft_fwd_itr);
    BOOST_TEST(-1 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('o' == bft_fwd_itr->key());
    BOOST_TEST(8 == **bft_fwd_itr);
    BOOST_TEST(-1 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('k' == bft_fwd_itr->key());
    BOOST_TEST(9 == **bft_fwd_itr);
    BOOST_TEST(7 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('n' == bft_fwd_itr->key());
    BOOST_TEST(10 == **bft_fwd_itr);
    BOOST_TEST(7 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('a' == bft_fwd_itr->key());
    BOOST_TEST(1 == **bft_fwd_itr);
    BOOST_TEST(-2 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('d' == bft_fwd_itr->key());
    BOOST_TEST(5 == **bft_fwd_itr);
    BOOST_TEST(-2 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('n' == bft_fwd_itr->key());
    BOOST_TEST(6 == **bft_fwd_itr);
    BOOST_TEST(-2 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('l' == bft_fwd_itr->key());
    BOOST_TEST(2 == **bft_fwd_itr);
    BOOST_TEST(1 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('m' == bft_fwd_itr->key());
    BOOST_TEST(3 == **bft_fwd_itr);
    BOOST_TEST(1 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('r' == bft_fwd_itr->key());
    BOOST_TEST(4 == **bft_fwd_itr);
    BOOST_TEST(1 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST(!bft_fwd_itr);
    bft_bkd_itr = ::odds_and_ends::node::make_breadth_first_tree_iterator<
        ::boost::mpl::true_
    >(atn_o00);
    BOOST_TEST(0 == **bft_bkd_itr);
    BOOST_TEST(!bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('t' == bft_bkd_itr->key());
    BOOST_TEST(-1 == **bft_bkd_itr);
    BOOST_TEST(0 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('i' == bft_bkd_itr->key());
    BOOST_TEST(-3 == **bft_bkd_itr);
    BOOST_TEST(0 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('A' == bft_bkd_itr->key());
    BOOST_TEST(13 == **bft_bkd_itr);
    BOOST_TEST(0 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('o' == bft_bkd_itr->key());
    BOOST_TEST(8 == **bft_bkd_itr);
    BOOST_TEST(-1 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('e' == bft_bkd_itr->key());
    BOOST_TEST(-2 == **bft_bkd_itr);
    BOOST_TEST(-1 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('t' == bft_bkd_itr->key());
    BOOST_TEST(12 == **bft_bkd_itr);
    BOOST_TEST(-3 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('s' == bft_bkd_itr->key());
    BOOST_TEST(11 == **bft_bkd_itr);
    BOOST_TEST(-3 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('n' == bft_bkd_itr->key());
    BOOST_TEST(7 == **bft_bkd_itr);
    BOOST_TEST(-3 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('n' == bft_bkd_itr->key());
    BOOST_TEST(6 == **bft_bkd_itr);
    BOOST_TEST(-2 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('d' == bft_bkd_itr->key());
    BOOST_TEST(5 == **bft_bkd_itr);
    BOOST_TEST(-2 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('a' == bft_bkd_itr->key());
    BOOST_TEST(1 == **bft_bkd_itr);
    BOOST_TEST(-2 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('n' == bft_bkd_itr->key());
    BOOST_TEST(10 == **bft_bkd_itr);
    BOOST_TEST(7 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('k' == bft_bkd_itr->key());
    BOOST_TEST(9 == **bft_bkd_itr);
    BOOST_TEST(7 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('r' == bft_bkd_itr->key());
    BOOST_TEST(4 == **bft_bkd_itr);
    BOOST_TEST(1 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('m' == bft_bkd_itr->key());
    BOOST_TEST(3 == **bft_bkd_itr);
    BOOST_TEST(1 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('l' == bft_bkd_itr->key());
    BOOST_TEST(2 == **bft_bkd_itr);
    BOOST_TEST(1 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST(!bft_bkd_itr);
    atn_n03.swap(atn_p07);
    BOOST_TEST(7 == **atn_n03.parent());
    BOOST_TEST(0 == **atn_p07.parent());
    BOOST_TEST(7 == **atn_o00.get('i'));
    bft_fwd_itr = ::odds_and_ends::node::make_breadth_first_tree_iterator(atn_o00);
    BOOST_TEST(0 == **bft_fwd_itr);
    BOOST_TEST(!bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('A' == bft_fwd_itr->key());
    BOOST_TEST(13 == **bft_fwd_itr);
    BOOST_TEST(0 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('i' == bft_fwd_itr->key());
    BOOST_TEST(7 == **bft_fwd_itr);
    BOOST_TEST(0 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('t' == bft_fwd_itr->key());
    BOOST_TEST(-1 == **bft_fwd_itr);
    BOOST_TEST(0 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('n' == bft_fwd_itr->key());
    BOOST_TEST(-3 == **bft_fwd_itr);
    BOOST_TEST(7 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('s' == bft_fwd_itr->key());
    BOOST_TEST(11 == **bft_fwd_itr);
    BOOST_TEST(7 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('t' == bft_fwd_itr->key());
    BOOST_TEST(12 == **bft_fwd_itr);
    BOOST_TEST(7 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('e' == bft_fwd_itr->key());
    BOOST_TEST(-2 == **bft_fwd_itr);
    BOOST_TEST(-1 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('o' == bft_fwd_itr->key());
    BOOST_TEST(8 == **bft_fwd_itr);
    BOOST_TEST(-1 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('k' == bft_fwd_itr->key());
    BOOST_TEST(9 == **bft_fwd_itr);
    BOOST_TEST(-3 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('n' == bft_fwd_itr->key());
    BOOST_TEST(10 == **bft_fwd_itr);
    BOOST_TEST(-3 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('a' == bft_fwd_itr->key());
    BOOST_TEST(1 == **bft_fwd_itr);
    BOOST_TEST(-2 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('d' == bft_fwd_itr->key());
    BOOST_TEST(5 == **bft_fwd_itr);
    BOOST_TEST(-2 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('n' == bft_fwd_itr->key());
    BOOST_TEST(6 == **bft_fwd_itr);
    BOOST_TEST(-2 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('l' == bft_fwd_itr->key());
    BOOST_TEST(2 == **bft_fwd_itr);
    BOOST_TEST(1 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('m' == bft_fwd_itr->key());
    BOOST_TEST(3 == **bft_fwd_itr);
    BOOST_TEST(1 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('r' == bft_fwd_itr->key());
    BOOST_TEST(4 == **bft_fwd_itr);
    BOOST_TEST(1 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST(!bft_fwd_itr);
    bft_bkd_itr = ::odds_and_ends::node::make_breadth_first_tree_iterator<
        ::boost::mpl::true_
    >(atn_o00);
    BOOST_TEST(0 == **bft_bkd_itr);
    BOOST_TEST(!bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('t' == bft_bkd_itr->key());
    BOOST_TEST(-1 == **bft_bkd_itr);
    BOOST_TEST(0 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('i' == bft_bkd_itr->key());
    BOOST_TEST(7 == **bft_bkd_itr);
    BOOST_TEST(0 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('A' == bft_bkd_itr->key());
    BOOST_TEST(13 == **bft_bkd_itr);
    BOOST_TEST(0 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('o' == bft_bkd_itr->key());
    BOOST_TEST(8 == **bft_bkd_itr);
    BOOST_TEST(-1 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('e' == bft_bkd_itr->key());
    BOOST_TEST(-2 == **bft_bkd_itr);
    BOOST_TEST(-1 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('t' == bft_bkd_itr->key());
    BOOST_TEST(12 == **bft_bkd_itr);
    BOOST_TEST(7 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('s' == bft_bkd_itr->key());
    BOOST_TEST(11 == **bft_bkd_itr);
    BOOST_TEST(7 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('n' == bft_bkd_itr->key());
    BOOST_TEST(-3 == **bft_bkd_itr);
    BOOST_TEST(7 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('n' == bft_bkd_itr->key());
    BOOST_TEST(6 == **bft_bkd_itr);
    BOOST_TEST(-2 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('d' == bft_bkd_itr->key());
    BOOST_TEST(5 == **bft_bkd_itr);
    BOOST_TEST(-2 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('a' == bft_bkd_itr->key());
    BOOST_TEST(1 == **bft_bkd_itr);
    BOOST_TEST(-2 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('n' == bft_bkd_itr->key());
    BOOST_TEST(10 == **bft_bkd_itr);
    BOOST_TEST(-3 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('k' == bft_bkd_itr->key());
    BOOST_TEST(9 == **bft_bkd_itr);
    BOOST_TEST(-3 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('r' == bft_bkd_itr->key());
    BOOST_TEST(4 == **bft_bkd_itr);
    BOOST_TEST(1 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('m' == bft_bkd_itr->key());
    BOOST_TEST(3 == **bft_bkd_itr);
    BOOST_TEST(1 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('l' == bft_bkd_itr->key());
    BOOST_TEST(2 == **bft_bkd_itr);
    BOOST_TEST(1 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST(!bft_bkd_itr);
    atn_p01.swap(atn_n02);
    BOOST_TEST(-1 == **atn_p01.parent());
    BOOST_TEST(1 == **atn_n02.parent());
    BOOST_TEST(1 == **atn_n01.get('e'));
    bft_fwd_itr = ::odds_and_ends::node::make_breadth_first_tree_iterator(atn_o00);
    BOOST_TEST(0 == **bft_fwd_itr);
    BOOST_TEST(!bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('A' == bft_fwd_itr->key());
    BOOST_TEST(13 == **bft_fwd_itr);
    BOOST_TEST(0 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('i' == bft_fwd_itr->key());
    BOOST_TEST(7 == **bft_fwd_itr);
    BOOST_TEST(0 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('t' == bft_fwd_itr->key());
    BOOST_TEST(-1 == **bft_fwd_itr);
    BOOST_TEST(0 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('n' == bft_fwd_itr->key());
    BOOST_TEST(-3 == **bft_fwd_itr);
    BOOST_TEST(7 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('s' == bft_fwd_itr->key());
    BOOST_TEST(11 == **bft_fwd_itr);
    BOOST_TEST(7 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('t' == bft_fwd_itr->key());
    BOOST_TEST(12 == **bft_fwd_itr);
    BOOST_TEST(7 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('e' == bft_fwd_itr->key());
    BOOST_TEST(1 == **bft_fwd_itr);
    BOOST_TEST(-1 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('o' == bft_fwd_itr->key());
    BOOST_TEST(8 == **bft_fwd_itr);
    BOOST_TEST(-1 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('k' == bft_fwd_itr->key());
    BOOST_TEST(9 == **bft_fwd_itr);
    BOOST_TEST(-3 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('n' == bft_fwd_itr->key());
    BOOST_TEST(10 == **bft_fwd_itr);
    BOOST_TEST(-3 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('a' == bft_fwd_itr->key());
    BOOST_TEST(-2 == **bft_fwd_itr);
    BOOST_TEST(1 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('d' == bft_fwd_itr->key());
    BOOST_TEST(5 == **bft_fwd_itr);
    BOOST_TEST(1 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('n' == bft_fwd_itr->key());
    BOOST_TEST(6 == **bft_fwd_itr);
    BOOST_TEST(1 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('l' == bft_fwd_itr->key());
    BOOST_TEST(2 == **bft_fwd_itr);
    BOOST_TEST(-2 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('m' == bft_fwd_itr->key());
    BOOST_TEST(3 == **bft_fwd_itr);
    BOOST_TEST(-2 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('r' == bft_fwd_itr->key());
    BOOST_TEST(4 == **bft_fwd_itr);
    BOOST_TEST(-2 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST(!bft_fwd_itr);
    bft_bkd_itr = ::odds_and_ends::node::make_breadth_first_tree_iterator<
        ::boost::mpl::true_
    >(atn_o00);
    BOOST_TEST(0 == **bft_bkd_itr);
    BOOST_TEST(!bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('t' == bft_bkd_itr->key());
    BOOST_TEST(-1 == **bft_bkd_itr);
    BOOST_TEST(0 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('i' == bft_bkd_itr->key());
    BOOST_TEST(7 == **bft_bkd_itr);
    BOOST_TEST(0 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('A' == bft_bkd_itr->key());
    BOOST_TEST(13 == **bft_bkd_itr);
    BOOST_TEST(0 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('o' == bft_bkd_itr->key());
    BOOST_TEST(8 == **bft_bkd_itr);
    BOOST_TEST(-1 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('e' == bft_bkd_itr->key());
    BOOST_TEST(1 == **bft_bkd_itr);
    BOOST_TEST(-1 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('t' == bft_bkd_itr->key());
    BOOST_TEST(12 == **bft_bkd_itr);
    BOOST_TEST(7 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('s' == bft_bkd_itr->key());
    BOOST_TEST(11 == **bft_bkd_itr);
    BOOST_TEST(7 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('n' == bft_bkd_itr->key());
    BOOST_TEST(-3 == **bft_bkd_itr);
    BOOST_TEST(7 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('n' == bft_bkd_itr->key());
    BOOST_TEST(6 == **bft_bkd_itr);
    BOOST_TEST(1 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('d' == bft_bkd_itr->key());
    BOOST_TEST(5 == **bft_bkd_itr);
    BOOST_TEST(1 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('a' == bft_bkd_itr->key());
    BOOST_TEST(-2 == **bft_bkd_itr);
    BOOST_TEST(1 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('n' == bft_bkd_itr->key());
    BOOST_TEST(10 == **bft_bkd_itr);
    BOOST_TEST(-3 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('k' == bft_bkd_itr->key());
    BOOST_TEST(9 == **bft_bkd_itr);
    BOOST_TEST(-3 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('r' == bft_bkd_itr->key());
    BOOST_TEST(4 == **bft_bkd_itr);
    BOOST_TEST(-2 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('m' == bft_bkd_itr->key());
    BOOST_TEST(3 == **bft_bkd_itr);
    BOOST_TEST(-2 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('l' == bft_bkd_itr->key());
    BOOST_TEST(2 == **bft_bkd_itr);
    BOOST_TEST(-2 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST(!bft_bkd_itr);
    atn_n01.swap(atn_p07);
    BOOST_TEST(0 == **atn_n01.parent());
    BOOST_TEST(0 == **atn_p07.parent());
    BOOST_TEST(-1 == **atn_o00.get('i'));
    BOOST_TEST(7 == **atn_o00.get('t'));
    bft_fwd_itr = ::odds_and_ends::node::make_breadth_first_tree_iterator(atn_o00);
    BOOST_TEST(0 == **bft_fwd_itr);
    BOOST_TEST(!bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('A' == bft_fwd_itr->key());
    BOOST_TEST(13 == **bft_fwd_itr);
    BOOST_TEST(0 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('i' == bft_fwd_itr->key());
    BOOST_TEST(-1 == **bft_fwd_itr);
    BOOST_TEST(0 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('t' == bft_fwd_itr->key());
    BOOST_TEST(7 == **bft_fwd_itr);
    BOOST_TEST(0 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('n' == bft_fwd_itr->key());
    BOOST_TEST(-3 == **bft_fwd_itr);
    BOOST_TEST(-1 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('s' == bft_fwd_itr->key());
    BOOST_TEST(11 == **bft_fwd_itr);
    BOOST_TEST(-1 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('t' == bft_fwd_itr->key());
    BOOST_TEST(12 == **bft_fwd_itr);
    BOOST_TEST(-1 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('e' == bft_fwd_itr->key());
    BOOST_TEST(1 == **bft_fwd_itr);
    BOOST_TEST(7 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('o' == bft_fwd_itr->key());
    BOOST_TEST(8 == **bft_fwd_itr);
    BOOST_TEST(7 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('k' == bft_fwd_itr->key());
    BOOST_TEST(9 == **bft_fwd_itr);
    BOOST_TEST(-3 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('n' == bft_fwd_itr->key());
    BOOST_TEST(10 == **bft_fwd_itr);
    BOOST_TEST(-3 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('a' == bft_fwd_itr->key());
    BOOST_TEST(-2 == **bft_fwd_itr);
    BOOST_TEST(1 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('d' == bft_fwd_itr->key());
    BOOST_TEST(5 == **bft_fwd_itr);
    BOOST_TEST(1 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('n' == bft_fwd_itr->key());
    BOOST_TEST(6 == **bft_fwd_itr);
    BOOST_TEST(1 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('l' == bft_fwd_itr->key());
    BOOST_TEST(2 == **bft_fwd_itr);
    BOOST_TEST(-2 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('m' == bft_fwd_itr->key());
    BOOST_TEST(3 == **bft_fwd_itr);
    BOOST_TEST(-2 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('r' == bft_fwd_itr->key());
    BOOST_TEST(4 == **bft_fwd_itr);
    BOOST_TEST(-2 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST(!bft_fwd_itr);
    bft_bkd_itr = ::odds_and_ends::node::make_breadth_first_tree_iterator<
        ::boost::mpl::true_
    >(atn_o00);
    BOOST_TEST(0 == **bft_bkd_itr);
    BOOST_TEST(!bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('t' == bft_bkd_itr->key());
    BOOST_TEST(7 == **bft_bkd_itr);
    BOOST_TEST(0 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('i' == bft_bkd_itr->key());
    BOOST_TEST(-1 == **bft_bkd_itr);
    BOOST_TEST(0 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('A' == bft_bkd_itr->key());
    BOOST_TEST(13 == **bft_bkd_itr);
    BOOST_TEST(0 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('o' == bft_bkd_itr->key());
    BOOST_TEST(8 == **bft_bkd_itr);
    BOOST_TEST(7 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('e' == bft_bkd_itr->key());
    BOOST_TEST(1 == **bft_bkd_itr);
    BOOST_TEST(7 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('t' == bft_bkd_itr->key());
    BOOST_TEST(12 == **bft_bkd_itr);
    BOOST_TEST(-1 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('s' == bft_bkd_itr->key());
    BOOST_TEST(11 == **bft_bkd_itr);
    BOOST_TEST(-1 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('n' == bft_bkd_itr->key());
    BOOST_TEST(-3 == **bft_bkd_itr);
    BOOST_TEST(-1 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('n' == bft_bkd_itr->key());
    BOOST_TEST(6 == **bft_bkd_itr);
    BOOST_TEST(1 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('d' == bft_bkd_itr->key());
    BOOST_TEST(5 == **bft_bkd_itr);
    BOOST_TEST(1 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('a' == bft_bkd_itr->key());
    BOOST_TEST(-2 == **bft_bkd_itr);
    BOOST_TEST(1 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('n' == bft_bkd_itr->key());
    BOOST_TEST(10 == **bft_bkd_itr);
    BOOST_TEST(-3 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('k' == bft_bkd_itr->key());
    BOOST_TEST(9 == **bft_bkd_itr);
    BOOST_TEST(-3 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('r' == bft_bkd_itr->key());
    BOOST_TEST(4 == **bft_bkd_itr);
    BOOST_TEST(-2 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('m' == bft_bkd_itr->key());
    BOOST_TEST(3 == **bft_bkd_itr);
    BOOST_TEST(-2 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('l' == bft_bkd_itr->key());
    BOOST_TEST(2 == **bft_bkd_itr);
    BOOST_TEST(-2 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST(!bft_bkd_itr);
    atn_o00.unset('t');
    bft_fwd_itr = ::odds_and_ends::node::make_breadth_first_tree_iterator(atn_o00);
    BOOST_TEST(0 == **bft_fwd_itr);
    BOOST_TEST(!bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('A' == bft_fwd_itr->key());
    BOOST_TEST(13 == **bft_fwd_itr);
    BOOST_TEST(0 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('i' == bft_fwd_itr->key());
    BOOST_TEST(-1 == **bft_fwd_itr);
    BOOST_TEST(0 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('n' == bft_fwd_itr->key());
    BOOST_TEST(-3 == **bft_fwd_itr);
    BOOST_TEST(-1 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('s' == bft_fwd_itr->key());
    BOOST_TEST(11 == **bft_fwd_itr);
    BOOST_TEST(-1 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('t' == bft_fwd_itr->key());
    BOOST_TEST(12 == **bft_fwd_itr);
    BOOST_TEST(-1 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('k' == bft_fwd_itr->key());
    BOOST_TEST(9 == **bft_fwd_itr);
    BOOST_TEST(-3 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST('n' == bft_fwd_itr->key());
    BOOST_TEST(10 == **bft_fwd_itr);
    BOOST_TEST(-3 == **bft_fwd_itr->parent());
    ++bft_fwd_itr;
    BOOST_TEST(!bft_fwd_itr);
    bft_bkd_itr = ::odds_and_ends::node::make_breadth_first_tree_iterator<
        ::boost::mpl::true_
    >(atn_o00);
    BOOST_TEST(0 == **bft_bkd_itr);
    BOOST_TEST(!bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('i' == bft_bkd_itr->key());
    BOOST_TEST(-1 == **bft_bkd_itr);
    BOOST_TEST(0 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('A' == bft_bkd_itr->key());
    BOOST_TEST(13 == **bft_bkd_itr);
    BOOST_TEST(0 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('t' == bft_bkd_itr->key());
    BOOST_TEST(12 == **bft_bkd_itr);
    BOOST_TEST(-1 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('s' == bft_bkd_itr->key());
    BOOST_TEST(11 == **bft_bkd_itr);
    BOOST_TEST(-1 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('n' == bft_bkd_itr->key());
    BOOST_TEST(-3 == **bft_bkd_itr);
    BOOST_TEST(-1 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('n' == bft_bkd_itr->key());
    BOOST_TEST(10 == **bft_bkd_itr);
    BOOST_TEST(-3 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST('k' == bft_bkd_itr->key());
    BOOST_TEST(9 == **bft_bkd_itr);
    BOOST_TEST(-3 == **bft_bkd_itr->parent());
    ++bft_bkd_itr;
    BOOST_TEST(!bft_bkd_itr);
}

int main(int argc, char** argv)
{
    test_00();
    test_01();
    test_02();
    return ::boost::report_errors();
}

